!function(){"use strict";function a(){$("form").removeData("validator"),$("form").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse("form")}function b(a){var b="发生错误,系统已记录,我们会尽快处理！";void 0!=a.response&&(401==a.response.status&&(location.href=I.loginUrl),b=a.response.data.message||b),I.alert({vm:a.vm,msg:b,fn:function(){a.vm.isSubmit=!1,$(".alertDialog").modal("hide")}})}function c(a){console.log(a);var b=function(b){I.alert({vm:a.vm,msg:b,fn:function(){a.vm.isSubmit=!1,$(".alertDialog").modal("hide")}})};if(a.response.status>400)b("发生错误！");else{var c=a.response.data;c&&555==c.status?b(c.message):a.fn&&a.fn(c)}}function d(){for(var a=arguments[0],b=1;b<arguments.length;b++){var c=new RegExp("\\{"+(b-1)+"\\}","gm");a=a.replace(c,arguments[b])}return a}function e(a){var b=a.toString().replace(/[^0-9]/g,"");return parseInt(b,10)}function f(a){return isNaN(parseFloat(a,10))?0:parseFloat(a,10)}function g(){return $(window).height()-180}function h(a){a.vm.alertDialogMessage=a.msg,a.vm.alertDialogFn=function(){a.fn?a.fn():$(".alertDialog").modal("hide")},$(".alertDialog").modal({backdrop:"static",keyboard:!1})}function i(a){a.vm.dialogConfirmTitle=a.title,a.vm.dialogConfirmMessage=a.msg,$(".confirmDialog").modal({backdrop:"static"}),a.vm.dialogConfirmSubmit=a.fn}function j(a,b){null==b&&(b=""),a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+a+"=([^&#]*)"),d=c.exec(window.location.href);return null==d?b:d[1]}function k(){return{filterable:{extra:!1,operators:{string:{contains:"包含",eq:"等于"},number:{eq:"等于",neq:"不等于",gt:"大于",lt:"小于"},date:{gt:"大于",lt:"小于"}}},pageable:{pageSize:10,previousNext:!0,buttonCount:5,refresh:!0,pageSizes:!0},schema:function(a){return{data:"value",total:function(a){return a.count},model:a}},transport:function(a){return{read:{url:a,dataType:"json",type:"GET",beforeSend:function(a){a.setRequestHeader("Token",I.getToken())}}}},noRecordMessage:{template:"暂时没有数据."}}}function l(a){var b=$(a).find("tr td:nth-child(1)").find("input:checked"),c=[];return b.each(function(){var a=$(this).attr("relId");c.push({name:"id",value:a})}),c}function m(a){a.headers={Token:I.getToken()},a.$http(a.httpOptions).then(a.success,function(b){common.requestError({vm:a.vm,response:b})})}function n(){var a={get:function(a,b){var c=this.getAll(a);return c?c[b]:null},getAll:function(a){var b=encodeURIComponent(a)+"=",c=document.cookie.indexOf(b),d=null,e={};if(c>-1){var f=document.cookie.indexOf(";",c);if(f==-1&&(f=document.cookie.length),d=document.cookie.substring(c+b.length,f),d.length>0){for(var g=d.split("&"),h=0,i=g.length;h<i;h++){var j=g[h].split("=");e[decodeURIComponent(j[0])]=decodeURIComponent(j[1])}return e}}return null},set:function(a,b,c,d,e,f,g){var h=this.getAll(a)||{};h[b]=c,this.setAll(a,h,d,e,f,g)},setAll:function(a,b,c,d,e,f){var g=encodeURIComponent(a)+"=",h=[];for(var i in b)i.length>0&&b.hasOwnProperty(i)&&h.push(encodeURIComponent(i)+"="+encodeURIComponent(b[i]));h.length>0?(g+=h.join("&"),c instanceof Date&&(g+=";expires="+c.toGMTString()),d&&(g+=";path="+d),e&&(g+=";domain="+e),f&&(g+=";secure")):g+=";expires="+new Date(0).toGMTString(),document.cookie=g},unset:function(a,b,c,d,e){var f=this.getAll(a);f&&(delete f[b],this.setAll(a,f,null,c,d,e))},unsetAll:function(a,b,c,d){this.setAll(a,null,new Date(0),b,c,d)}};return a}function o(){var a=n().getAll("data");return null!=a?a.token:""}function p(a){return a.error=function(a){401==a.status&&(location.href=I.loginUrl)},a}function q(){return window.global_basicData?window.global_basicData:($.ajax({url:"/common/basicData/all",async:!1,success:function(a){window.global_basicData=a}}),window.global_basicData)}function r(a){var b=$linq(common.getBasicData()).where(function(b){return b.id==a}).firstOrDefault();return b?b.description:""}function s(a){var b=$linq(q()).where(function(b){return b.identity==a&&b.pId==a}).toArray();return b?b:""}function t(a){return a?new Date(a):null}function u(a){return a?a:0}function v(a){return a?kendo.toString(new Date(a),"yyyy-MM-dd"):null}function w(a){return a?kendo.toString(new Date(a),"yyyy-MM-dd HH:mm:ss"):null}function x(){return{uploadSize:10485760,processState:"processState",processState_waitQianShou:"processState_1",processState_qianShou:"processState_2",processState_banJie:"processState_7",processState_tuiWen:"processState_11",projectShenBaoStage:"projectShenBaoStage",projectShenBaoStage_nextYearPlan:"projectShenBaoStage_7",projectShenBaoStage_projectProposal:"projectShenBaoStage_9",projectShenBaoStage_KXXYJBG:"projectShenBaoStage_10",projectShenBaoStage_CBSJYGS:"projectShenBaoStage_11",projectShenBaoStage_junGong:"projectShenBaoStage_6",projectCategory:"projectCategory",projectCategory_A:"projectCategory_1",projectCategory_B:"projectCategory_2",projectCategory_C:"projectCategory_3",projectCategory_D:"projectCategory_4",projectClassify:"projectClassify",projectClassify_ZF:"projectClassify_1",projectClassify_SH:"projectClassify_2",projectConstrChar:"projectConstrChar",projectConstrChar_qianqi:"projectConstrChar_1",projectConstrChar_xinkaigong:"projectConstrChar_2",projectConstrChar_xujian:"projectConstrChar_3",projectConstrChar_chubei:"projectConstrChar_4",projectFunctionClassify:"projectFunctionClassify",projectGoverEconClassify:"projectGoverEconClassify",projectInvestmentType:"projectInvestmentType",projectInvestmentType_ZF:"projectInvestmentType_1",projectInvestmentType_SH:"projectInvestmentType_2",projectIndustry:"projectIndustry",projectIndustry_ZF:"projectIndustry_1",projectIndustry_SH:"projectIndustry_2",projectProgress:"projectProgress",projectStage:"projectStage",projectType:"projectType",approvalType:"approvalType",unitProperty:"unitProperty",area:"area",area_GM:"area_1",capitalOtherType:"capitalOtherType",taskType:"taskType",taskType_monthReport:"taskType_1",taskType_yearPlan:"taskType_2",taskType_sendMesg:"taskType_3",taskType_shenBao:"taskType_4",taskType_JYS:"taskType_5",taskType_KXXYJBG:"taskType_6",taskType_CBSJYGS:"taskType_7",taskType_qianQi:"taskType_8",taskType_newStart:"taskType_9",taskType_xuJian:"taskType_10",auditState:"auditState",auditState_noAudit:"auditState_1",auditState_auditPass:"auditState_2",auditState_auditNotPass:"auditState_3",management:"管理员"}}function y(a,b,c){if(a){var d=a.length;d>b?$("#"+c).html("<font size='5'>0</font>"):d<=b&&$("#"+c).html("<font size='5'>"+(b-d)+"</font>")}else $("#"+c).html("<font size='5'>"+b+"</font>")}function z(){return{projectShenBaoStage_projectProposal:[["ApplyReport_pdf",'申请报告（pdf版，加盖公章）<span class="required">(*)</span>'],["ApplyReport_word",'申请报告（Word版）<span class="required">(*)</span>'],["HYJY",'会议纪要及依据 <span class="required">(*)</span>'],["Project_ProPosal","项目建议书（需委托有相应资质的咨询机构按照规范编写）"],["other","其他资料"]],projectShenBaoStage_KXXYJBG:[["ApplyReport_pdf",'申请报告（pdf版，加盖公章）<span class="required">(*)</span>'],["ApplyReport_word",'申请报告（Word版）<span class="required">(*)</span>'],["ProjectProPosalReply_Scanning",'项目建议书（或前期工作计划）批复扫描件 <span class="required">(*)</span>'],["KXXYJ_Report","项目可行性研究报告（包括项目建设、管养、招投标等内容）"],["GHXZProposal_Scanning","规划选址意见书扫描件"],["YDYS_Scanning","用地预审扫描件"],["HPPW_Scanning","环评批文扫描件"],["other","其他资料"]],projectShenBaoStage_CBSJYGS:[["ApplyReport_pdf",'申请报告（pdf版，加盖公章）<span class="required">(*)</span>'],["ApplyReport_word",'申请报告（Word版）<span class="required">(*)</span>'],["ProjectProPosal_Reply","项目建议书（或前期工作计划）、可行性研究报告"],["CBSJYGS_Material","初步设计及项目总概算材料（项目单位需委托有相应资质的咨询机构编制项目总概算）"],["YDGHXKZ_Scanning","用地规划许可证扫描件"],["other","其他资料"]],projectShenBaoStage_YearPlan:[["XXJD","项目工程形象进度及年度资金需求情况"],["WCJSNR","年度完成建设内容及各阶段工作内容完成时间表"],["TTJH",'历年政府投资计划下大文件  <span class="required">(*)</span>'],["GCXKZ","建设工程规划许可证"],["TDQK","土地落实情况、征地拆迁有关情况"],["XMJZ","项目进展情况相关资料"],["QQGZJH","前期工作计划文件"],["XMSSYJ","项目实施依据文件"],["HYJY","会议纪要"]],projectShenBaoStage_qianQi:[["ProjectBasis",'项目依据  <span class="required">(*)</span>'],["other","其他"]],projectShenBaoStage_newStart:[["ApplyReport_pdf",'申请报告（pdf版，加盖公章）<span class="required">(*)</span>'],["ApplyReport_word",'申请报告（Word版）<span class="required">(*)</span>'],["BudgetReply_Scanning",'概算批复扫描件 <span class="required">(*)</span>'],["GCGHXKZ_Scanning","工程规划许可证扫描件"],["IssuedReplyFile_Scanning",'全部已下达计划批复文件扫描件 <span class="required">(*)</span>'],["other","其他"]],projectShenBaoStage_xuJian:[["ApplyReport_pdf",'申请报告（pdf版，加盖公章）<span class="required">(*)</span>'],["ApplyReport_word",'申请报告（Word版）<span class="required">(*)</span>'],["LastYearPlanReply_Copy",'上一年度计划批文复印件 <span class="required">(*)</span>'],["IssuedReplyFile_Scanning",'全部已下达计划批复文件扫描件 <span class="required">(*)</span>'],["other","其他"]],projectShenBaoStage_junGong:[["ApplyReport_pdf",'申请报告（pdf版，加盖公章）<span class="required">(*)</span>'],["ApplyReport_word",'申请报告（Word版）<span class="required">(*)</span>'],["LastYearPlanReply_Copy",'上一年度计划批文复印件 <span class="required">(*)</span>'],["IssuedReplyFile_Scanning",'全部已下达计划批复文件扫描件 <span class="required">(*)</span>'],["other","其他"]],projectEdit:[["XMJYSPF","项目建议书批复文本"],["KXXYJBGPF","可行性研究报告批复文本"],["ZGSPFTZ","总概算批复及调整文本"],["HYJY","会议纪要"],["GHYJ","规划依据"],["SJXGT","设计效果图"],["XMQWT","项目区位图"],["XCTP","现场图片"],["QT","其他"]],projectEdit_SH:[["XMJYSPF","项目建议书批复文本"],["KXXYJBGPF","可行性研究报告批复文本"],["ZGSPFTZ","总概算批复及调整文本"],["HYJY","会议纪要"],["GHYJ","规划依据"],["SJXGT","设计效果图"],["XMQWT","项目区位图"],["XCTP","现场图片"],["QT","其他"]]}}function A(a,b){var c=[];if(null!=a&&""!=a){if(a.constructor==Array)return a;if(""==b)return c.push(a),c;for(var d=0,e=0,f=a.length;d<f;)e=a.indexOf(b,d),e!=-1?(""!=a.substring(d,e)&&c.push(a.substring(d,e)),d=e+1):(""!=a.substring(d,f)&&c.push(a.substring(d,f)),d=f)}return c}function B(a,b){var c="";if(null!=a&&a.length>0){if(a.constructor==String)return b;for(var d=0;d<a.length;d++)""!=a[d]&&(c=""==c?a[d]:c+b+a[d])}return c}function C(a){var b=parseFloat(a);if(!isNaN(b))return b=Math.round(1e4*a)/1e4}function D(){return window.global_userUnits?window.global_userUnits:($.ajax({url:"/common/userUnit",async:!1,success:function(a){window.global_userUnits=a}}),window.global_userUnits)}function E(a){for(var b=D(),c="",d=0;d<b.length;d++){var e=b[d];if(a==e.id){c=e.unitName;break}}return c}function F(a){function b(a,b,d){c+=parseFloat(a)}var c=0;return a.forEach(b),C(c)}function G(a){for(var b="",c=0,d=0;d<a.length;d++)c=a.charCodeAt(d),b+=String.fromCharCode(c>0&&c<128?c+65248:c);return b}function H(){$(document).on("click","#checkboxAll",function(){var a=$(this).is(":checked");$(".grid").find("tr td:nth-child(1)").find("input:checkbox").prop("checked",a)}),$("body").on("click",".grid tr",function(a){$(this).parent().find("tr").removeClass("selected"),$(this).addClass("selected")})}var I={initJqValidation:a,requestError:b,requestSuccess:c,format:d,blockNonNumber:e,floatNumberInput:f,adminContentHeight:g,alert:h,confirm:i,getQuerystring:j,kendoGridConfig:k,getKendoCheckId:l,cookie:n,getToken:o,appPath:"",http:m,gridDataSource:p,loginUrl:"/",getBasicData:q,getBasicDataDesc:r,getBacicDataByIndectity:s,toDate:t,toMoney:u,formatDate:v,formatDateTime:w,basicDataConfig:x,checkLength:y,uploadFileTypeConfig:z,stringToArray:A,arrayToString:B,toDecimal4:C,getUserUnits:D,getUnitName:E,getSum:F,repSign:G};window.common=I,H()}(),function(){"use strict";angular.module("app",["ui.router","kendo.directives","textAngular"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("index",{url:"/",templateUrl:"/admin/welcome.html",controller:"roleCtrl",controllerAs:"vm"}).state("role",{url:"/role",templateUrl:"/role/html/list.html",controller:"roleCtrl",controllerAs:"vm"}).state("roleEdit",{url:"/roleEdit/:id",templateUrl:"/role/html/edit.html",controller:"roleEditCtrl",controllerAs:"vm"}).state("user",{url:"/user",templateUrl:"/user/html/list.html",controller:"userCtrl",controllerAs:"vm"}).state("userEdit",{url:"/userEdit/:id",templateUrl:"/user/html/edit.html",controller:"userEditCtrl",controllerAs:"vm"}).state("org",{url:"/org",templateUrl:"/org/html/list.html",controller:"orgCtrl",controllerAs:"vm"}).state("orgEdit",{url:"/orgEdit/:id",templateUrl:"/org/html/edit.html",controller:"orgEditCtrl",controllerAs:"vm"}).state("orgUser",{url:"/orgUser/:id",templateUrl:"/org/html/orgUser.html",controller:"orgUserCtrl",controllerAs:"vm"}).state("log",{url:"/log",templateUrl:"/log/html/list.html",controller:"logCtrl",controllerAs:"vm"}).state("accountPwd",{url:"/accountPwd",templateUrl:"/account/html/changePwd.html",controller:"homeCtrl",controllerAs:"vm"}).state("demo",{url:"/demo",templateUrl:"/demo/html/list.html",controller:"demoCtrl",controllerAs:"vm"}).state("portal",{url:"/portal/:type",templateUrl:"/management/portal/html/list",controller:"portalCtrl",controllerAs:"vm"}).state("portalEdit",{url:"/portal/:type/:id",templateUrl:"/management/portal/html/edit",controller:"portalCtrl",controllerAs:"vm"}).state("monthReport",{url:"/monthReport",templateUrl:"/management/monthReport/html/list",controller:"monthReportCtrl",controllerAs:"vm"}).state("monthReportChange",{url:"/monthReportChange/:projectId/:year/:month",templateUrl:"/management/monthReport/html/changeDetails",controller:"monthReportCtrl",controllerAs:"vm"}).state("monthReport_details",{url:"/monthReport/:projectId/:year/:month",templateUrl:"/management/monthReport/html/details",controller:"monthReportCtrl",controllerAs:"vm"}).state("project",{url:"/project",templateUrl:"/management/project/html/list.html",controller:"projectCtrl",controllerAs:"vm"}).state("projectEdit",{url:"/projectEdit/:id/:projectInvestmentType",templateUrl:"/management/project/html/edit.html",controller:"projectCtrl",controllerAs:"vm"}).state("projectDetails",{url:"/projectDetails/:id/:projectInvestmentType",templateUrl:"/management/project/html/details.html",controller:"projectCtrl",controllerAs:"vm"}).state("project_SH",{url:"/project_SH",templateUrl:"/management/project/html/list_SH.html",controller:"projectCtrl",controllerAs:"vm"}).state("unitManagement",{url:"/unitManagement",templateUrl:"/unitManagement/html/list.html",controller:"unitManagementCtrl",controllerAs:"vm"}).state("unitManagementEdit",{url:"/unitManagementEdit/:id",templateUrl:"/unitManagement/html/edit.html",controller:"unitManagementEditCtrl",controllerAs:"vm"}).state("basicData",{url:"/basicData",templateUrl:"/management/basicData/html/index",controller:"basicDataCtrl",controllerAs:"vm"}).state("sysConfig",{url:"/sysConfig",templateUrl:"/sys/html/index",controller:"sysConfigCtrl",controllerAs:"vm"}).state("yearPlan_shenbaoInfoList",{url:"/yearPlan/shenbaoInfoList",templateUrl:"/management/yearPlan/html/shenbaoInfoList",controller:"yearPlanCtrl",controllerAs:"vm"}).state("yearPlan_shenbaoInfoEdit",{url:"/yearPlan/shenbaoInfoEdit/:id/:projectInvestmentType/:stage",templateUrl:"/management/yearPlan/html/shenbaoInfoEdit",controller:"yearPlanCtrl",controllerAs:"vm"}).state("yearPlan_planList",{url:"/yearPlan/planList",templateUrl:"/management/yearPlan/html/planList",controller:"yearPlanCtrl",controllerAs:"vm"}).state("yearPlan_planEdit",{url:"/yearPlan/planEdit/:id",templateUrl:"/management/yearPlan/html/planEdit",controller:"yearPlanCtrl",controllerAs:"vm"}).state("yearPlan_planBZ",{url:"/yearPlan/planBZ/:id",templateUrl:"/management/yearPlan/html/planBZ",controller:"yearPlanCtrl",controllerAs:"vm"}).state("task_todo",{url:"/task/todo",templateUrl:"/management/task/html/todo",controller:"taskCtrl",controllerAs:"vm"}).state("task_handle",{url:"/task/todo/:taskType/:taskId/:relId",templateUrl:"/management/task/html/handle",controller:"taskCtrl",controllerAs:"vm"}).state("task_complete",{url:"/task/complete",templateUrl:"/management/task/html/complete",controller:"taskCtrl",controllerAs:"vm"})}])}(),function(){"use strict";function a(a,b){function c(){$("#datepicker").kendoDatePicker({culture:"zh-CN"})}function d(){$("#files").kendoUpload({async:{saveUrl:"/demo/save",removeUrl:"/demo/remove",autoUpload:!0}}),$("#files2").kendoUpload({async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},showFileList:!1,select:function(a){console.log("select:"),console.log(a)},error:function(a){if(console.log("error:"),console.log(a),200==a.XMLHttpRequest.status){var b=a.XMLHttpRequest.response;alert("文件名："+b)}},localization:{select:"选择文件"}})}function e(){c(),d(),b.treeList(f),f.init_select()}var f=this;f.title="",f.tabActive=1,f.tab=function(a){f.tabActive=a},f.showDialog=function(){$(".myDialog").modal({backdrop:"static",keyboard:!1})},f.setCookie=function(){common.cookie().set("myCookie","userName",f.cookie.userName),common.cookie().set("myCookie","password",f.cookie.password)},f.getCookie=function(){var a=common.cookie().get("myCookie","userName"),b=common.cookie().get("myCookie","password");alert(common.format("用户名:{0},密码:{1}",a,b))},f.textSubmit=function(){alert(f.content)},f.init_select=function(){f.parentCategory="",f.childCategory="";var a=common.getBasicData();f.parentList=$linq(a).where(function(a){return"projectIndustry"==a.identity&&""==a.pId}).toArray(),f.parentChange=function(){f.childList=$linq(a).where(function(a){return a.pId==f.parentCategory}).toArray()}},f.popOver=function(a){f.isPopOver=!0,f.popStyle={border:"1px solid #ccc",height:"200px",width:"120px",position:"absolute",background:"white",left:a.pageX+"px",top:a.pageY+"px"},f.content="内容"},e()}angular.module("app").controller("demoCtrl",a),a.$inject=["$location","demoSvc"]}(),function(){"use strict";function a(a){function b(a){var b="https://demos.telerik.com/kendo-ui/service",c={transport:{read:{url:b+"/EmployeeDirectory/All",dataType:"jsonp"}},schema:{model:{id:"EmployeeId",parentId:"ReportsTo",fields:{EmployeeId:{type:"number",editable:!1,nullable:!1},ReportsTo:{nullable:!0,type:"number"},FirstName:{validation:{required:!0}},LastName:{validation:{required:!0}},HireDate:{type:"date"},Phone:{type:"string"},BirthDate:{type:"date"},Extension:{type:"number",validation:{min:0,required:!0}},Position:{type:"string"}}}}},d=[{field:"FirstName",title:"First Name",width:"150px"},{field:"LastName",title:"Last Name",width:"150px"},{field:"Position"},{title:"Location",template:"{{ dataItem.City }}, {{ dataItem.Country }}"},{command:["edit"]}];a.treelistOptions={dataSource:c,columns:d}}function c(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0;var e={method:"put",url:d,data:b.model.password},f=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:e,success:f})}}var d="/account/password",e={upload:c,treeList:b};return e}angular.module("app").factory("demoSvc",a),a.$inject=["$http"]}(),function(){"use strict";function a(a,b){function c(){}var d=this;d.title="",d.changePwd=function(){b.changePwd(d)},c()}angular.module("app").controller("homeCtrl",a),a.$inject=["$location","homeSvc"]}(),function(){"use strict";function a(a){function b(b){common.initJqValidation();var d=$("form").valid();if(d){b.isSubmit=!0;var e={method:"put",url:c,data:b.model.password},f=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:e,success:f})}}var c="/account/password",d={changePwd:b};return d}angular.module("app").factory("homeSvc",a),a.$inject=["$http"]}(),function(){"use strict";function a(a,b){function c(){b.grid(d)}var d=this;d.title="日志列表",c()}angular.module("app").controller("logCtrl",a),a.$inject=["$location","logSvc"]}(),function(){"use strict";function a(a,b){function c(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{field:"id",title:"ID",width:80,filterable:!1},{field:"level",title:"级别",width:100,filterable:!0},{field:"message",title:"日志内容",filterable:!1},{field:"userId",title:"操作者",width:150,filterable:!0},{field:"createdDate",title:"操作时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}var d="/log",e={grid:c};return e}angular.module("app").factory("logSvc",a),a.$inject=["$http","$compile"]}(),function(){"use strict";function a(a,b){function c(){b.grid(d)}var d=this;d.title="部门列表",d.del=function(a){common.confirm({vm:d,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),b.deleteOrg(d,a)}})},d.dels=function(){var a=common.getKendoCheckId(".grid");if(0==a.length)common.alert({vm:d,msg:"请选择数据"});else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);var e=b.join(",");d.del(e)}},c()}angular.module("app").controller("orgCtrl",a),a.$inject=["$location","orgSvc"]}(),function(){"use strict";function a(a,b,c){function d(){e.isUpdate&&b.getOrgById(e)}var e=this;e.title="新增部门",e.isorgExist=!1,e.id=c.params.id,e.id&&(e.isUpdate=!0,e.title="更新部门"),e.create=function(){b.createOrg(e)},e.update=function(){b.updateOrg(e)},d()}angular.module("app").controller("orgEditCtrl",a),a.$inject=["$location","orgSvc","$state"]}(),function(){"use strict";function a(a,b,c,d){function e(){c.getOrgById(f),d.orgUserGrid(f),d.allUserGrid(f)}var f=this;f.id=b.params.id,f.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),f.orgUserGrid.dataSource.read()},f.closeAddUserDialog=function(){$(".addUser").modal("hide")},f.add=function(a){d.add(f,a)},f.remove=function(a){d.remove(f,a)},f.removes=function(){var a=common.getKendoCheckId(".orgUserGrid");if(0==a.length)common.alert({vm:f,msg:"请选择数据"});else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);var d=b.join(",");f.remove(d)}},e()}angular.module("app").controller("orgUserCtrl",a),a.$inject=["$location","$state","orgSvc","orgUserSvc"]}(),function(){"use strict";function a(a,b){function c(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(h),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"orgIdentity",title:"部门标识",width:200,filterable:!1},{field:"name",title:"部门名称",width:200,filterable:!1},{field:"comment",title:"描述",filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"操作",width:280,template:function(a){return common.format($("#columnBtns").html(),"vm.del('"+a.id+"')",a.id)}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function d(b){common.initJqValidation();var c=$("form").valid();if(c&&0==b.isorgExist){b.isSubmit=!0;var d={method:"post",url:h,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=i}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}}function e(b){var c={method:"get",url:common.format(h+"?$filter=id eq '{0}'",b.id)},d=function(a){b.model=a.data.value[0]||{},b.isUpdate};common.http({vm:b,$http:a,httpOptions:c,success:d})}function f(b){common.initJqValidation();var c=$("form").valid();if(c&&0==b.isorgExist){b.isSubmit=!0,b.model.id=b.id;var d={method:"put",url:h,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}}function g(b,c){b.isSubmit=!0;var d={method:"delete",url:h,data:c},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){b.isSubmit=!1,b.gridOptions.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}var h="/org",i="#/org",j={grid:c,createOrg:d,getOrgById:e,updateOrg:f,deleteOrg:g};return j}angular.module("app").factory("orgSvc",a),a.$inject=["$http","$compile"]}(),function(){"use strict";function a(a,b){function c(b,c){var d={method:"delete",url:common.format(h,b.id),data:c},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){b.gridOptions.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}function d(b,c){var d={method:"post",url:common.format(h,b.id),data:c},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){b.orgUserGrid.dataSource.read(),b.gridOptions.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}function e(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(common.format(g,a.id)),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{field:"loginName",title:"登录名",width:200,filterable:!0},{field:"displayName",title:"显示名",width:200,filterable:!0},{field:"comment",title:"描述",filterable:!1},{field:"",title:"操作",width:80,template:function(a){return common.format($("#allUserGridBtns").html(),"vm.add('"+a.id+"')",a.id)}}];a.orgUserGrid={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function f(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(common.format(h,a.id)),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!1,serverSorting:!1,serverFiltering:!1,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"loginName",title:"登录名",width:200,filterable:!1},{field:"displayName",title:"显示名",width:200,filterable:!1},{field:"comment",title:"描述",filterable:!1},{field:"",title:"操作",width:180,template:function(a){return common.format($("#columnBtns").html(),"vm.remove('"+a.id+"')",a.id)}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}var g="/org/{0}/userNotIn",h="/org/{0}/users",i={orgUserGrid:f,allUserGrid:e,add:d,remove:c};return i}angular.module("app").factory("orgUserSvc",a),a.$inject=["$http","$compile"]}(),function(){"use strict";function a(a,b){function c(){b.grid(d)}var d=this;d.title="角色列表",d.del=function(a){common.confirm({vm:d,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),b.deleteRole(d,a)}})},d.dels=function(){var a=common.getKendoCheckId(".grid");if(0==a.length)common.alert({vm:d,msg:"请选择数据"});else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);var e=b.join(",");d.del(e)}},c()}angular.module("app").controller("roleCtrl",a),a.$inject=["$location","roleSvc"]}(),function(){"use strict";function a(a,b,c){function d(){e.isUpdate?b.getRoleById(e):b.initZtreeClient(e)}var e=this;e.title="添加角色",e.isRoleExist=!1,e.id=c.params.id,e.id&&(e.isUpdate=!0,e.title="更新角色"),e.create=function(){b.createRole(e)},e.update=function(){b.updateRole(e)},e.checkRole=function(){b.checkRole(e)},d()}angular.module("app").controller("roleEditCtrl",a),a.$inject=["$location","roleSvc","$state"]}(),function(){"use strict";function a(a,b){function c(){var a=$.fn.zTree.getZTreeObj("zTree"),b=a.getCheckedNodes(!0);return b}function d(a){for(var b=$.fn.zTree.getZTreeObj("zTree"),c=$linq(a.model.resources).select(function(a){return a.path}).toArray(),d=b.getNodesByParam("level",1,null),e=$linq(d).where(function(a){return $linq(c).contains(a.path)}).toArray(),f=0,g=e.length;f<g;f++)b.checkNode(e[f],!0,!0)}function e(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"roleName",title:"角色名称",width:200,filterable:!1},{field:"comment",title:"描述",filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"操作",width:180,template:function(a){return common.format($("#columnBtns").html(),"vm.del('"+a.id+"')",a.id)}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function f(b){common.initJqValidation();var d=$("form").valid();if(d&&0==b.isRoleExist){b.isSubmit=!0;var e=c(),f=$linq(e).where(function(a){return 0==a.isParent}).select(function(a){return{id:a.id,name:a.name,path:a.path,method:a.method}}).toArray();b.model.resources=f;var g={method:"post",url:l,data:b.model},h=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=m}})}})};common.http({vm:b,$http:a,httpOptions:g,success:h})}}function g(a){}function h(b){var c={method:"get",url:common.format(l+"?$filter=id eq '{0}'",b.id)},d=function(a){b.model=a.data.value[0],b.isUpdate&&k(b)};common.http({vm:b,$http:a,httpOptions:c,success:d})}function i(b){common.initJqValidation();var d=$("form").valid();if(d&&0==b.isRoleExist){b.isSubmit=!0,b.model.id=b.id;var e=c(),f=$linq(e).where(function(a){return 0==a.isParent}).select(function(a){return{id:a.id,name:a.name,path:a.path,method:a.method}}).toArray();b.model.resources=f;var g={method:"put",url:l,data:b.model},h=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:g,success:h})}}function j(b,c){b.isSubmit=!0;var d={method:"delete",url:l,data:c},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){b.isSubmit=!1,b.gridOptions.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}function k(b){var c={method:"get",url:n},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){var c,e={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},f=a.data;c=$.fn.zTree.init($("#zTree"),e,f),b.isUpdate&&d(b)}})};common.http({vm:b,$http:a,httpOptions:c,success:e})}var l="/role",m="#/role",n="/sys/resource",o={grid:e,createRole:f,checkRole:g,getRoleById:h,updateRole:i,deleteRole:j,initZtreeClient:k};return o}angular.module("app").factory("roleSvc",a),a.$inject=["$http","$compile"]}(),function(){"use strict";function a(a,b){function c(){b.grid(d)}var d=this;d.title="用户列表",d.del=function(a){common.confirm({vm:d,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),b.deleteUser(d,a)}})},d.dels=function(){var a=common.getKendoCheckId(".grid");if(0==a.length)common.alert({vm:d,msg:"请选择数据"});else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);var e=b.join(",");d.del(e)}},c()}angular.module("app").controller("userCtrl",a),a.$inject=["$location","userSvc"]}(),function(){
"use strict";function a(a,b,c){function d(){e.isUpdate?b.getUserById(e):b.initZtreeClient(e)}var e=this;e.model={},e.title="添加用户",e.isuserExist=!1,e.id=c.params.id,e.id&&(e.isUpdate=!0,e.title="更新用户"),e.create=function(){b.createUser(e)},e.update=function(){b.updateUser(e)},e.initPassword=function(a){var b=$("#initPassword").is(":checked");b?(e.model.password="888888",e.model.passwordConfirm="888888"):(e.model.password="",e.model.passwordConfirm="")},d()}angular.module("app").controller("userEditCtrl",a),a.$inject=["$location","userSvc","$state"]}(),function(){"use strict";function a(a){function b(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0,b.model.id=b.id;var d=h(),e=$linq(d).where(function(a){return 0==a.isParent}).select(function(a){return{id:a.id,roleName:a.name}}).toArray();b.model.roles=e;var f={method:"put",url:j,data:b.model},g=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:f,success:g})}else common.alert({vm:b,msg:"您填写的信息不正确,请核对后提交!"})}function c(b,c){b.isSubmit=!0;var d={method:"delete",url:j,data:c},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){b.isSubmit=!1,b.gridOptions.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}function d(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0;var d=h(),e=$linq(d).where(function(a){return 0==a.isParent}).select(function(a){return{id:a.id,roleName:a.name}}).toArray();b.model.roles=e;var f={method:"post",url:j,data:b.model},g=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=k}})}})};common.http({vm:b,$http:a,httpOptions:f,success:g})}}function e(b){var c={method:"get",url:l},d=function(a){common.requestSuccess({vm:b,response:a,fn:function(){var c,d={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},e=$linq(a.data.value).select(function(a){return{id:a.id,name:a.roleName}}).toArray(),f={id:"",name:"角色集合",children:e};c=$.fn.zTree.init($("#zTree"),d,f),b.isUpdate&&i(b)}})};common.http({vm:b,$http:a,httpOptions:c,success:d})}function f(b){var c={method:"get",url:common.format(j+"?$filter=id eq '{0}'",b.id)},d=function(a){b.model=a.data.value[0],b.isUpdate&&e(b)};common.http({vm:b,$http:a,httpOptions:c,success:d})}function g(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(j),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"loginName",title:"登录名",width:200,filterable:!0},{field:"displayName",title:"显示名",width:200,filterable:!0},{field:"comment",title:"描述",filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"操作",width:180,template:function(a){return common.format($("#columnBtns").html(),"vm.del('"+a.id+"')",a.id)}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function h(){var a=$.fn.zTree.getZTreeObj("zTree"),b=a.getCheckedNodes(!0);return b}function i(a){for(var b=$.fn.zTree.getZTreeObj("zTree"),c=$linq(a.model.roles).select(function(a){return a.roleName}).toArray(),d=b.getNodesByParam("level",1,null),e=$linq(d).where(function(a){return $linq(c).contains(a.name)}).toArray(),f=0,g=e.length;f<g;f++)b.checkNode(e[f],!0,!0)}var j="/user",k="#/user",l="/role",m={grid:g,getUserById:f,initZtreeClient:e,createUser:d,deleteUser:c,updateUser:b};return m}angular.module("app").factory("userSvc",a),a.$inject=["$http"]}(),function(){"use strict";function a(a,b,c,d){function e(){var a,c=common.getBasicData(),d={view:{nameIsHTML:!0,addHoverDom:function(a,d){if(0!=d.level&&d.canEdit){var e=$("#"+d.tId+"_span");if(d.editNameFlag||$("#addBtn_"+d.tId).length>0)return;var f="<span class='button add' id='addBtn_"+d.tId+"' title='添加子节点' onfocus='this.blur();'></span>";e.after(f);var h=$("#addBtn_"+d.tId);h&&h.bind("click",function(){window.global_basicData=null,c=common.getBasicData();var a,e,f,h=$.fn.zTree.getZTreeObj("zTree"),i=$linq(c).where(function(a){return a.pId==d.id}).select(function(a){return{id:a.id}}).toArray();if(i.length>0){for(var j=[],k=0,l=0;l<i.length;l++){var m=i[l].id,n=m.split("_");j[k+l]=parseInt(n[n.length-1],10)}var o=Math.max.apply(null,j);a=i[0].id,f=a.split("_"),f[f.length-1]=o+1,e=f.join("_")}else a=d.id,e=a+"_1";var p={id:e,name:"请编辑命名",identity:d.identity,pId:d.id,canEdit:!0};h.addNodes(d,p),g.model.id=p.id,g.model.description=p.name,g.model.identity=p.identity,g.model.pId=p.pId,g.model.canEdit=p.canEdit,b.createBasicData(g)})}},removeHoverDom:function(a,b){$("#addBtn_"+b.tId).unbind().remove()},showIcon:!0,selectedMulti:!0},edit:{enable:!0,showRenameBtn:function(a,b){return!(0==b.level||!b.canEdit)},showRemoveBtn:function(a,b){return!(b.isParent||!b.canEdit)},removeTitle:"删除",renameTitle:"编辑"},callback:{onRename:function(a,c,d){g.model.id=d.id,g.model.description=d.name,g.model.identity=d.identity,g.model.pId=d.pId,b.updateBasicData(g)},onRemove:function(a,c,d){b.deleteBasicData(g,d.id)}}},e=function(a){return $linq(c).where(function(b){return b.pId==a}).select(function(a){return{id:a.id,name:a.description,pId:a.pId,identity:a.identity,canEdit:a.canEdit,children:e(a.id)}}).toArray()},f=$linq(c).where(function(a){return""==a.pId}).select(function(a){return{id:a.id,name:common.format("{0}{1}",a.description,a.canEdit?"":'<span style="color:red">[不可编辑]</span>'),pId:a.pId,canEdit:a.canEdit,identity:a.identity,children:e(a.id)}}).toArray(),h={id:"",name:"基础数据",children:f};a=$.fn.zTree.init($("#zTree"),d,h)}function f(){g.init()}var g=this;g.init=function(){g.model={},e()},f()}angular.module("app").controller("basicDataCtrl",a),a.$inject=["$location","basicDataSvc","$state","$scope"]}(),function(){"use strict";function a(a,b){function c(b){var c={method:"put",url:f,data:b.model},d=function(a){common.requestSuccess({vm:b,response:a})};common.http({vm:b,$http:a,httpOptions:c,success:d})}function d(b,c){var d={method:"delete",url:f,data:c},e=function(a){common.requestSuccess({vm:b,response:a})};common.http({vm:b,$http:a,httpOptions:d,success:e})}function e(b){var c={method:"post",url:f,data:b.model},d=function(a){common.requestSuccess({vm:b,response:a})};common.http({vm:b,$http:a,httpOptions:c,success:d})}var f="/management/basicData",g={createBasicData:e,deleteBasicData:d,updateBasicData:c};return g}angular.module("app").factory("basicDataSvc",a),a.$inject=["$http","$compile"]}(),function(){"use strict";function a(a,b,c,d){function e(){h.init(),"list"==h.page&&f(),"details"==h.page&&g(),"changeDetails"==h.page&&g()}function f(){b.grid(h),h.search=function(){var a=[];a.push({field:"isLatestVersion",operator:"eq",value:!0}),a.push({field:"isMonthReport",operator:"eq",value:!0}),null!=h.search.projectName&&""!=h.search.projectName&&a.push({field:"projectName",operator:"contains",value:h.search.projectName}),null!=h.search.projectStage&&""!=h.search.projectStage&&a.push({field:"projectStage",operator:"eq",value:h.search.projectStage}),null!=h.search.projectInvestmentType&&""!=h.search.projectInvestmentType&&a.push({field:"projectInvestmentType",operator:"eq",value:h.search.projectInvestmentType}),null!=h.search.unitName&&""!=h.search.unitName&&a.push({field:"unitName",operator:"contains",value:h.search.unitName}),h.gridOptions.dataSource.filter(a),h.gridOptions.dataSource.read()}}function g(){b.getProjectById(h),h.model.isReportExist=!1,h.createProblem=function(){h.model.monthReport.monthReportProblemDtos?h.model.monthReport.monthReportProblemDtos.push({problemIntroduction:"",solutionsAndSuggest:""}):h.model.monthReport.monthReportProblemDtos=[{problemIntroduction:"",solutionsAndSuggest:""}]},h.deleteProblem=function(a){h.model.monthReport.monthReportProblemDtos.splice(a,1)},h.uploadSuccess=function(a){var b=$(a.sender.element).parents(".uploadBox").attr("data-type");if(200==a.XMLHttpRequest.status){var c=a.XMLHttpRequest.response;d.$apply(function(){h.model.monthReport.attachmentDtos?h.model.monthReport.attachmentDtos.push({name:c.split("_")[2],url:c,type:b}):h.model.monthReport.attachmentDtos=[{name:c.split("_")[2],url:c,type:b}]})}},h.onSelect=function(a){$.each(a.files,function(a,b){b.size>common.basicDataConfig().uploadSize&&d.$apply(function(){common.alert({vm:h,msg:"上传文件过大！"})})})},h.uploadOptions={async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},error:h.uploadSuccess,localization:{select:"上传文件"},showFileList:!1,multiple:!0,validation:{maxFileSize:common.basicDataConfig().uploadSize},select:h.onSelect},h.delFile=function(a){h.model.monthReport.attachmentDtos.splice(a,1)},h.basicData_approvalType=$linq(common.getBasicData()).where(function(a){return"approvalType"==a.identity&&"approvalType"==a.pId}).toArray(),h.basicData_projectProgress=$linq(common.getBasicData()).where(function(a){return"projectProgress"==a.identity&&"projectProgress"==a.pId}).toArray(),h.uploadType=[["scenePicture","现场图片"],["other","其它材料"]],h.submit=function(){b.submitMonthReport(h)},h.change=function(){location.href="#/monthReportChange/"+h.projectId+"/"+h.year+"/"+h.month},h.befor=function(){h.model.display=!0,b.getProjectById(h)},h.back=function(a){location.href="#/monthReport"}}var h=this;h.projectId=c.params.projectId,h.year=c.params.year,h.month=c.params.month,h.search={},h.model={},h.basicData={},h.page="list",h.model.display=!1,h.init=function(){"monthReport_details"==c.current.name?h.page="details":"monthReportChange"==c.current.name&&(h.page="changeDetails"),h.getBasicDataDesc=function(a){return common.getBasicDataDesc(a)},h.checkLength=function(a,b,c){common.checkLength(a,b,c)},h.basicData.projectStage=common.getBacicDataByIndectity(common.basicDataConfig().projectStage),h.basicData.projectInvestmentType=common.getBacicDataByIndectity(common.basicDataConfig().projectInvestmentType)},e()}angular.module("app").controller("monthReportCtrl",a),a.$inject=["$location","monthReportSvc","$state","$scope"]}(),function(){"use strict";function a(a,b,c){function d(b){var c={method:"get",url:common.format(g+"?$filter=id eq '{0}'",b.projectId)},d=function(a){if(b.model.projectInfo=a.data.value[0]||{},"details"==b.page||"changeDetails"==b.page){var c=$linq(b.model.projectInfo.monthReportDtos).where(function(a){return a.submitYear==b.year&&a.submitMonth==b.month}).toArray();if(c.length>0){if(1==b.model.display)for(var d=0;d<c.length;d++)0==c[d].isLatestVersion&&(b.model.monthReport=c[d]);else for(var e=0;e<c.length;e++)1==c[e].isLatestVersion&&(b.model.monthReport=c[e]);b.model.monthReport.pifuJYS_date=common.toDate(b.model.projectInfo.pifuJYS_date),b.model.monthReport.pifuKXXYJBG_date=common.toDate(b.model.projectInfo.pifuKXXYJBG_date),b.model.monthReport.pifuCBSJYGS_date=common.toDate(b.model.projectInfo.pifuCBSJYGS_date),b.model.monthReport.beginDate=common.formatDate(b.model.monthReport.beginDate),b.model.monthReport.endDate=common.formatDate(b.model.monthReport.endDate),b.model.monthReport.invertPlanTotal=common.toMoney(b.model.monthReport.invertPlanTotal),b.model.monthReport.actuallyFinishiInvestment=common.toMoney(b.model.monthReport.actuallyFinishiInvestment),b.model.monthReport.thisYearPlanInvestment=common.toMoney(b.model.monthReport.thisYearPlanInvestment),b.model.monthReport.thisYearAccumulatedInvestment=common.toMoney(b.model.monthReport.thisYearAccumulatedInvestment),b.model.monthReport.thisMonthInvestTotal=common.toMoney(b.model.monthReport.thisMonthInvestTotal),b.model.monthReport.firstQuarCompInvestment=common.toMoney(b.model.monthReport.firstQuarCompInvestment),b.model.monthReport.secondQuarCompInvestment=common.toMoney(b.model.monthReport.secondQuarCompInvestment),b.model.monthReport.thirdQuarCompInvestment=common.toMoney(b.model.monthReport.thirdQuarCompInvestment),b.model.monthReport.fourthQuarCompInvestment=common.toMoney(b.model.monthReport.fourthQuarCompInvestment)}}};common.http({vm:b,$http:a,httpOptions:c,success:d})}function e(b){common.initJqValidation();var d=$("form").valid();if(d){b.model.monthReport.submitYear=b.year,b.model.monthReport.submitMonth=b.month,b.model.monthReport.projectId=b.projectId;var e={method:"post",url:h,data:b.model.monthReport},f=function(a){b.model.isReportExist=!0,b.model.isSubmit=!1,common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),c.path(i)}})}})};common.http({vm:b,$http:a,httpOptions:e,success:f})}}function f(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(g),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:[{field:"isLatestVersion",operator:"eq",value:!0},{field:"isMonthReport",operator:"eq",value:!0}]}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"projectName",title:"项目名称",template:function(a){return common.format('<a href="#/projectDetails/{0}/{1}">{2}</a>',a.id,a.projectInvestmentType,a.projectName)},filterable:!0},{field:"unitName",title:"建设单位名称",filterable:!0},{field:"projectInvestmentType",title:"投资类型",template:function(a){return common.getBasicDataDesc(a.projectInvestmentType)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().projectInvestmentType),dataTextField:"description",dataValueField:"id"})}}},{field:"",title:"填报月份",template:function(a){var b="";return a.monthReportDtos.forEach(function(a,c){b+=common.format('<a class="btn btn-xs btn-success" ng-show="{3}" href="#/monthReport/{0}/{1}/{2}">{1}年{2}月</a> ',a.projectId,a.submitYear,a.submitMonth,a.isLatestVersion)}),b},width:800,filterable:!1}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}var g="/management/project",h="/management/monthReport",i="/monthReport",j={grid:f,getProjectById:d,submitMonthReport:e};return j}angular.module("app").factory("monthReportSvc",a),a.$inject=["$http","$compile","$location"]}(),function(){"use strict";function a(a,b,c,d){function e(){f.init(),"list"==f.page&&b.grid(f),"update"==f.page&&b.getById(f),"create"!=f.page&&"update"!=f.page||f.init_upload()}var f=this;f.type=c.params.type,f.id=c.params.id,f.init=function(){switch(f.type){case"tzgg":f.title="通知公告";break;case"zcfg":f.title="政策法规";break;case"bszn":f.title="办事指南";break;case"cybg":f.title="常用表格"}switch(f.id){case void 0:f.page="list";break;case"":f.page="create";break;default:f.page="update"}},f.init_upload=function(){f.onSelect=function(a){$.each(a.files,function(a,b){b.size>common.basicDataConfig().uploadSize&&d.$apply(function(){common.alert({vm:f,msg:"上传文件过大！"})})})},$("#files").kendoUpload({async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},showFileList:!1,select:f.onSelect,success:function(a){},error:function(a){if(console.log("error:"),console.log(a),200==a.XMLHttpRequest.status){var b=a.XMLHttpRequest.response;d.$apply(function(){f.model.attachmentDtos?f.model.attachmentDtos.push({name:b.split("_")[2],url:b,type:f.type}):f.model.attachmentDtos=[{name:b.split("_")[2],url:b,type:f.type}]})}},localization:{select:"上传文件"},validation:{maxFileSize:common.basicDataConfig().uploadSize}})},f.delFile=function(a){f.model.attachmentDtos.splice(a,1)},f.del=function(a){common.confirm({vm:f,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),b.del(f,a)}})},f.dels=function(){var a=common.getKendoCheckId(".grid");if(0==a.length)common.alert({vm:f,msg:"请选择数据"});else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);var d=b.join(",");f.del(d)}},f.create=function(){b.create(f)},f.update=function(){b.update(f)},e()}angular.module("app").controller("portalCtrl",a),a.$inject=["$location","portalSvc","$state","$scope"]}(),function(){"use strict";function a(a,b){function c(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(h),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:{field:"type",operator:"eq",value:a.type}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"title",title:"标题",filterable:!1},{field:"createdDate",title:"创建时间",width:180,template:function(a){return common.formatDateTime(a.createdDate)},filterable:!1},{field:"",title:"操作",width:180,template:function(a){return common.format($("#columnBtns").html(),a.id)}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function d(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0,b.model.type=b.type;var d={method:"post",url:h,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=i+b.type}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}else common.alert({vm:b,msg:"您填写的信息不正确,请核对后提交!"})}function e(b){var c={method:"get",url:common.format(h+"?$filter=id eq '{0}'",b.id)},d=function(a){b.model=a.data.value[0],b.model.files&&(b.files=b.model.files.split(";"))};common.http({vm:b,$http:a,httpOptions:c,success:d})}function f(b){var c=$("form").valid();if(c){b.isSubmit=!0,b.model.id=b.id;var d={method:"put",url:h,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=i+b.type}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}}function g(b,c){b.isSubmit=!0;var d={method:"delete",url:h,data:c},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){b.isSubmit=!1,b.gridOptions.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}var h="/management/portal",i="#/portal/",j={grid:c,create:d,getById:e,update:f,del:g};return j}angular.module("app").factory("portalSvc",a),a.$inject=["$http","$compile"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){"project"==c.current.name&&(l.isZFInvestment=!0),"project_SH"==c.current.name&&(l.isSHInvestment=!0),"projectEdit"==c.current.name&&(l.page="create"),l.id&&(l.page="update"),"projectDetails"==c.current.name&&(l.page="details"),l.getBasicDataDesc=function(a){return common.getBasicDataDesc(a)},l.checkLength=function(a,b,c){common.checkLength(a,b,c)},l.html=function(a){return e.trustAsHtml(a)},l.basicData.projectStage=common.getBacicDataByIndectity(common.basicDataConfig().projectStage),l.basicData.projectType=common.getBacicDataByIndectity(common.basicDataConfig().projectType),l.basicData.projectCategory=common.getBacicDataByIndectity(common.basicDataConfig().projectCategory),l.basicData.investmentType=common.getBacicDataByIndectity(common.basicDataConfig().projectInvestmentType),l.basicData.area_Street=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().area&&a.pId==common.basicDataConfig().area_GM}).toArray(),l.basicData.userUnit=common.getUserUnits()}function g(){"list"==l.page&&h(),"create"==l.page&&(l.model.projectType=[],i()),"update"==l.page&&(i(),j()),"details"==l.page&&k()}function h(){l.isZFInvestment&&b.grid(l),l.isSHInvestment&&b.grid_SH(l),b.grid(l),l.search=function(){var a=[];a.push({field:"isLatestVersion",operator:"eq",value:!0}),l.isZFInvestment&&(a.push({field:"projectInvestmentType",operator:"eq",value:common.basicDataConfig().projectInvestmentType_ZF}),a.push({field:"isIncludLibrary",operator:"eq",value:!0})),l.isSHInvestment&&a.push({field:"projectInvestmentType",operator:"eq",value:common.basicDataConfig().projectInvestmentType_SH}),null!=l.search.projectName&&""!=l.search.projectName&&a.push({field:"projectName",operator:"contains",value:l.search.projectName}),null!=l.search.projectStage&&""!=l.search.projectStage&&a.push({field:"projectStage",operator:"eq",value:l.search.projectStage}),null!=l.search.isMonthReport&&""!=l.search.isMonthReport&&("true"==l.search.isMonthReport?a.push({field:"isMonthReport",operator:"eq",value:!0}):"false"==l.search.isMonthReport&&a.push({field:"isMonthReport",operator:"eq",value:!1})),null!=l.search.unitName&&""!=l.search.unitName&&a.push({field:"unitName",operator:"eq",value:l.search.unitName}),l.isZFInvestment?l.gridOptions.dataSource.filter(a):l.isSHInvestment&&l.gridOptions_SH.dataSource.filter(a)},l.addProject=function(){$("#myModal_add").modal({backdrop:"static",keyboard:!1})},l.confirmInvestmentType=function(){$(".modal-backdrop").remove(),a.path("/projectEdit//"+l.model.projectInvestmentType)},l.model.projectInvestmentType=common.basicDataConfig().projectInvestmentType_ZF,l.isMonthReport=function(a,b){l.model.isMonthReport=b,l.model.id=a,$("#myModal_edit").modal({backdrop:"static",keyboard:!1})},l.updateIsMonthReport=function(){b.updateIsMonthReport(l)},l.del=function(a){common.confirm({vm:l,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),b.deleteProject(l,a)}})},l.dels=function(){var a=common.getKendoCheckId(".grid");if(0==a.length)common.alert({vm:l,msg:"请选择数据"});else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);var d=b.join(",");l.del(d)}}}function i(){l.model.projectInvestmentType=l.projectInvestmentType,l.projectInvestmentType==common.basicDataConfig().projectInvestmentType_ZF?(l.basicData.projectClassify=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectClassify&&a.pId==common.basicDataConfig().projectClassify_ZF}).toArray(),l.basicData.projectIndustry=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_ZF}).toArray(),l.isZFInvestment=!0):l.projectInvestmentType==common.basicDataConfig().projectInvestmentType_SH&&(l.basicData.projectClassify=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectClassify&&a.pId==common.basicDataConfig().projectClassify_SH}).toArray(),l.basicData.projectIndustry=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_SH}).toArray(),l.projectIndustryChange=function(){l.basicData.projectIndustryChildren=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==l.model.projectIndustryParent}).toArray()},l.isSHInvestment=!0),b.getUserUnits(l),l.updateSelection=function(a){var b=l.model.projectType.indexOf(a);b==-1?l.model.projectType.push(a):l.model.projectType.splice(b,1)},l.uploadType=[["JYS","项目建议书批复"],["KXXYJBG","可行性研究报告批复"],["CBSJYGS","初步设计与概算批复"]],l.relatedType=common.uploadFileTypeConfig().projectEdit,l.uploadSuccess=function(a){var b=$(a.sender.element).parents(".uploadBox").attr("data-type");if(200==a.XMLHttpRequest.status){var c=a.XMLHttpRequest.response;d.$apply(function(){l.model.attachmentDtos?l.model.attachmentDtos.push({name:c.split("_")[2],url:c,type:b}):l.model.attachmentDtos=[{name:c.split("_")[2],url:c,type:b}]})}},l.choseDocument=function(a){l.pifuType=$(a.target).parents(".uploadBox").attr("data-type"),$("#documentRecords").modal({backdrop:"static",keyboard:!1}),l.gridOptions_documentRecords.dataSource.read()},b.documentRecordsGird(l),l.pifuChoseConfirm=function(){$("#documentRecords").modal("hide"),$(".modal-backdrop").remove();var a=common.getKendoCheckId(".grid"),b=a[0].value;if(b){var c=common.stringToArray(b,","),d=c[0],e=c[1],f=c[2];l.model["pifu"+l.pifuType+"_wenhao"]=d,l.model.attachmentDtos?l.model.attachmentDtos.push({name:e,url:f,type:l.pifuType}):l.model.attachmentDtos=[{name:e,url:f,type:l.pifuType}]}},l.onSelect=function(a){$.each(a.files,function(a,b){b.size>common.basicDataConfig().uploadSize&&d.$apply(function(){common.alert({vm:l,msg:"上传文件过大！"})})})},l.uploadOptions_pifu={async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},error:l.uploadSuccess,localization:{select:"上传文件"},showFileList:!1,multiple:!1,validation:{maxFileSize:common.basicDataConfig().uploadSize},select:l.onSelect},l.uploadOptions={async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},error:l.uploadSuccess,localization:{select:"上传文件"},showFileList:!1,multiple:!0,validation:{maxFileSize:common.basicDataConfig().uploadSize},select:l.onSelect},l.delFile=function(a){var b=l.model.attachmentDtos[a];if(b){var c=b.type;l.model["pifu"+c+"_wenhao"]="",l.model.attachmentDtos.splice(a,1)}},l.capitalTotal=function(){return common.getSum([l.model.capitalSCZ_ggys||0,l.model.capitalSCZ_gtzj||0,l.model.capitalSCZ_zxzj||0,l.model.capitalQCZ_ggys||0,l.model.capitalQCZ_gtzj||0,l.model.capitalSHTZ||0,l.model.capitalZYYS||0,l.model.capitalOther||0])},l.create=function(){b.createProject(l)}}function j(){l.title="编辑项目",b.getProjectById(l),l.update=function(){b.updateProject(l)}}function k(){b.getProjectById(l),l.projectInvestmentType==common.basicDataConfig().projectInvestmentType_ZF?(l.isZFInvestment=!0,l.relatedType=common.uploadFileTypeConfig().projectEdit):l.projectInvestmentType==common.basicDataConfig().projectInvestmentType_SH&&(l.isSHInvestment=!0,l.relatedType=common.uploadFileTypeConfig().projectEdit_SH),l.relatedType=common.uploadFileTypeConfig().projectEdit}var l=this;l.title="新增项目",l.search={},l.model={},l.basicData={},l.id=c.params.id,l.projectInvestmentType=c.params.projectInvestmentType,l.page="list",f(),g()}angular.module("app").controller("projectCtrl",a),a.$inject=["$location","projectSvc","$state","$scope","$sce"]}(),function(){"use strict";function a(a){function b(b){var c={method:"get",url:common.format(l+"?$filter=id eq '{0}'",b.model.unitName)},d=function(a){b.userUnit=a.data.value[0]||{}};common.http({vm:b,$http:a,httpOptions:c,success:d})}function c(b){var c={method:"get",url:l},d=function(a){b.userUnits=a.data.value};common.http({vm:b,$http:a,httpOptions:c,success:d})}function d(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0,b.model.projectType=common.arrayToString(b.model.projectType,",");var d={method:"post",url:k,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),b.isZFInvestment?location.href=m:b.isSHInvestment&&(location.href=n)}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}else common.alert({vm:b,msg:"您填写的信息不正确,请核对后提交!"})}function e(b){var c={method:"put",url:k+"/isMonthReport",data:b.model},d=function(a){$("#myModal_edit").modal("hide"),b.isZFInvestment?b.gridOptions.dataSource.read():b.isSHInvestment&&b.gridOptions_SH.dataSource.read()};common.http({vm:b,$http:a,httpOptions:c,success:d})}function f(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0,b.model.projectType=common.arrayToString(b.model.projectType,",");var d={method:"put",url:k,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),b.isZFInvestment?location.href=m:b.isSHInvestment&&(location.href=n)}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}else common.alert({vm:b,msg:"您填写的信息不正确,请核对后提交!"})}function g(c){var d={method:"get",url:common.format(k+"?$filter=id eq '{0}'",c.id)},e=function(a){if(c.model=a.data.value[0]||{},b(c),c.model.projectType=common.stringToArray(c.model.projectType,","),c.model.beginDate=common.formatDate(c.model.beginDate),c.model.endDate=common.formatDate(c.model.endDate),c.model.pifuJYS_date=common.formatDate(c.model.pifuJYS_date),c.model.pifuKXXYJBG_date=common.formatDate(c.model.pifuKXXYJBG_date),c.model.pifuCBSJYGS_date=common.formatDate(c.model.pifuCBSJYGS_date),c.model.projectInvestSum=common.toMoney(c.model.projectInvestSum),c.model.projectInvestAccuSum=common.toMoney(c.model.projectInvestAccuSum),c.model.capitalSCZ_ggys=common.toMoney(c.model.capitalSCZ_ggys),c.model.capitalSCZ_gtzj=common.toMoney(c.model.capitalSCZ_gtzj),c.model.capitalSCZ_zxzj=common.toMoney(c.model.capitalSCZ_zxzj),c.model.capitalQCZ_ggys=common.toMoney(c.model.capitalQCZ_ggys),c.model.capitalQCZ_gtzj=common.toMoney(c.model.capitalQCZ_gtzj),c.model.capitalZYYS=common.toMoney(c.model.capitalZYYS),c.model.capitalSHTZ=common.toMoney(c.model.capitalSHTZ),c.model.capitalOther=common.toMoney(c.model.capitalOther),"update"==c.page&&c.model.projectInvestmentType==common.basicDataConfig().projectInvestmentType_SH){var d=$linq(common.getBasicData()).where(function(a){return a.id==c.model.projectIndustry}).toArray()[0];c.model.projectIndustryParent=d.pId,c.projectIndustryChange()}"details"==c.page&&(c.capitalTotal=function(){return common.getSum([c.model.capitalSCZ_ggys||0,c.model.capitalSCZ_gtzj||0,c.model.capitalSCZ_zxzj||0,c.model.capitalQCZ_ggys||0,c.model.capitalQCZ_gtzj||0,c.model.capitalSHTZ||0,c.model.capitalZYYS||0,c.model.capitalOther||0])})};common.http({vm:c,$http:a,httpOptions:d,success:e})}function h(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(o),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),c=[{template:function(a){return kendo.format("<input type='radio'  relId='{0},{1},{2}' name='checkbox'/>",a.number,a.name,a.fullName)},filterable:!1,width:40,title:""},{field:"number",title:"文号",width:180,filterable:!0},{field:"name",title:"文件名",width:550,template:function(a){return common.format("<a href='/contents/upload/{1}'>{0}</a>",a.name,a.fullName)},filterable:!0}];a.gridOptions_documentRecords={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function i(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(common.format(k+"/unitName")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},isMonthReport:{type:"boolean"},isIncludLibrary:{type:"boolean"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:[{field:"projectInvestmentType",operator:"eq",value:common.basicDataConfig().projectInvestmentType_ZF},{field:"isLatestVersion",operator:"eq",value:!0},{field:"isIncludLibrary",operator:"eq",value:!0}]}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"projectNumber",
title:"项目代码",width:180,filterable:!1},{field:"projectName",title:"项目名称",template:function(a){return common.format("<a href='#/projectDetails/{0}/{1}'>{2}</a>",a.id,a.projectInvestmentType,a.projectName)},filterable:!0},{field:"unitName",title:"项目所属单位",width:150,filterable:{ui:function(b){b.kendoDropDownList({valuePrimitive:!0,dataSource:a.basicData.userUnit,dataTextField:"unitName",dataValueField:"id"})}},template:function(a){return common.getUnitName(a.unitName)}},{field:"projectStage",title:"项目阶段",width:150,template:function(a){return common.getBasicDataDesc(a.projectStage)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().projectStage),dataTextField:"description",dataValueField:"id"})}}},{field:"projectClassify",title:"项目分类",width:150,template:function(a){return common.getBasicDataDesc(a.projectClassify)},filterable:!1},{field:"isMonthReport",title:"是否月报",template:function(a){return a.isMonthReport?"是":a.isMonthReport?void 0:"否"},width:150,filterable:!0},{field:"",title:"操作",width:250,template:function(a){return common.format($("#columnBtns").html(),a.id,a.projectInvestmentType,"vm.isMonthReport('"+a.id+"','"+a.isMonthReport+"')")}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function j(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(k),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},isMonthReport:{type:"boolean"},isIncludLibrary:{type:"boolean"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:[{field:"isLatestVersion",operator:"eq",value:!0},{field:"projectInvestmentType",operator:"eq",value:common.basicDataConfig().projectInvestmentType_SH}]}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"projectNumber",title:"项目代码",width:180,filterable:!1},{field:"projectName",title:"项目名称",template:function(a){return common.format("<a href='#/projectDetails/{0}/{1}'>{2}</a>",a.id,a.projectInvestmentType,a.projectName)},filterable:!0},{field:"unitName",title:"建设单位",width:150,filterable:!0},{field:"projectStage",title:"项目阶段",width:150,template:function(a){return common.getBasicDataDesc(a.projectStage)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().projectStage),dataTextField:"description",dataValueField:"id"})}}},{field:"projectClassify",title:"项目分类",width:150,template:function(a){return common.getBasicDataDesc(a.projectClassify)},filterable:!1},{field:"isMonthReport",title:"是否月报",template:function(a){return a.isMonthReport?"是":a.isMonthReport?void 0:"否"},width:150,filterable:!0},{field:"",title:"操作",width:250,template:function(a){return common.format($("#columnBtns").html(),a.id,a.projectInvestmentType,"vm.isMonthReport('"+a.id+"','"+a.isMonthReport+"')")}}];a.gridOptions_SH={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}var k="/management/project",l="/management/userUnit",m="#/project",n="#/project_SH",o="/management/replyFile",p={grid:i,grid_SH:j,getProjectById:g,getUserUnits:c,updateProject:f,createProject:d,updateIsMonthReport:e,documentRecordsGird:h};return p}angular.module("app").factory("projectSvc",a),a.$inject=["$http"]}(),function(){"use strict";function a(a,b,c,d){function e(){h(),g(),f()}function f(){b.getSysConfigs(i);for(var a=0;a<i.model.taskList.length;a++)i.model.checkedButton[a]=!0;i.checked=function(a){for(var b=0;b<i.model.checkedButton.length;b++)a==b&&(i.model.checkedButton[b]=!1)},i.userChange=function(a,b){i.model.taskList[a].taskUser=b,i.hasChange=!0},i.create=function(){b.createTaskUser(i)}}function g(){b.getAllUser(i)}function h(){b.getAllTask(i)}var i=this;i.title="",i.model={},i.model.config=[],i.model.checkedButton=[],e()}angular.module("app").controller("sysConfigCtrl",a),a.$inject=["$location","sysConfigSvc","$state","$scope"]}(),function(){"use strict";function a(a){function b(b){var c={method:"get",url:h,data:b.model},d=function(a){b.userTaskList=a.data;for(var c=0;c<b.userTaskList.length;c++)for(var d=0;d<b.model.taskList.length;d++)b.userTaskList[c].configName==b.model.taskList[d].id&&b.userTaskList[c].configType==common.basicDataConfig().taskType&&(b.userTaskList[c].configName==common.basicDataConfig().taskType_monthReport||b.userTaskList[c].configName==common.basicDataConfig().taskType_yearPlan?b.model.taskList[d].taskUser=b.userTaskList[c].configValue:b.userTaskList[c].configName!=common.basicDataConfig().taskType_sendMesg&&b.userTaskList[c].configName!=common.basicDataConfig().taskType_shenBao||(b.model.taskList[d].taskEnable=b.userTaskList[c].enable))};common.http({vm:b,$http:a,httpOptions:c,success:d})}function c(b){var c=[];for(var d in b.model.taskList)c.push({configName:b.model.taskList[d].id,configValue:b.model.taskList[d].taskUser,enable:b.model.config[d].enable});var e={method:"post",url:g,data:c},f=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.reload()}})}})};common.http({vm:b,$http:a,httpOptions:e,success:f})}function d(b){var c={method:"get",url:f,data:b.model},d=function(a){b.userList=a.data.value,b.user=[];for(var c=0;c<b.userList.length;c++)for(var d=b.userList[c].roles,e=0;e<d.length;e++)d[e].roleName==common.basicDataConfig().management&&b.user.push(b.userList[c])};common.http({vm:b,$http:a,httpOptions:c,success:d})}function e(a){a.model.taskList=common.getBacicDataByIndectity(common.basicDataConfig().taskType)}var f="/user",g="/sys/create",h="/sys/getSysConfigs",i={getAllUser:d,getAllTask:e,createTaskUser:c,getSysConfigs:b};return i}angular.module("app").factory("sysConfigSvc",a),a.$inject=["$http"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){"task_todo"==c.current.name&&(l.page="todoList"),"task_handle"==c.current.name&&(l.page="handle"),"task_complete"==c.current.name&&(l.page="complete"),l.formatDate=function(a){return common.formatDate(a)},l.getBasicDataDesc=function(a){return common.getBasicDataDesc(a)},l.checkLength=function(a,b,c){common.checkLength(a,b,c)},l.html=function(a){return e.trustAsHtml(a)},l.callBack=function(){window.history.back(-1)}}function h(){g(),"todoList"==l.page&&i(),"handle"==l.page&&k(),"complete"==l.page&&j()}function i(){b.grid(l)}function j(){b.completeGird(l)}function k(){l.processState_qianShou=common.basicDataConfig().processState_qianShou,l.processState_tuiWen=common.basicDataConfig().processState_tuiWen,b.getTaskById(l),l.taskType==common.basicDataConfig().taskType_yearPlan?(l.isYearPlan=!0,b.getShenBaoInfoById(l),l.model.taskRecord.processSuggestion="符合申报"):l.taskType==common.basicDataConfig().taskType_monthReport&&(l.isMonthReport=!0,b.getMonthReportById(l)),l.dialog_shenbaoInfo=function(){$("#shenbaoInfo").modal({backdrop:"static",keyboard:!1}),l.tabStripOptions={}},l.handle=function(a){common.initJqValidation();var c=$("form").valid();c&&(l.isSubmit=!0,l.model.taskRecord.processState=a,b.handle(l))}}var l=this;l.title="",l.model={},l.taskType=c.params.taskType,l.taskId=c.params.taskId,l.relId=c.params.relId,l.page="todoList",l.filters=[],l.model.taskRecord={},h()}angular.module("app").controller("taskCtrl",a),a.$inject=["$location","taskSvc","$state","$scope","$sce","$rootScope"]}(),function(){"use strict";function a(a,b){function c(b){var c={method:"get",url:common.format(n+"?$filter=id eq '{0}'",b.model.monthReport.projectId)},d=function(a){b.model.project=a.data.value[0]||{},""!=b.model.project.projectType&&void 0!=b.model.project.projectType?b.model.project.projectType=b.model.project.projectType.split(","):b.model.project.projectType=[]};common.http({vm:b,$http:a,httpOptions:c,success:d})}function d(b){var d={method:"get",url:common.format(m+"?$filter=id eq '{0}'",b.relId)},e=function(a){b.model.monthReport=a.data.value[0]||{},c(b),b.model.monthReport.beginDate=common.formatDate(b.model.monthReport.beginDate),b.model.monthReport.endDate=common.formatDate(b.model.monthReport.endDate),b.uploadType=[["scenePicture","现场图片"],["other","其它材料"]]};common.http({vm:b,$http:a,httpOptions:d,success:e})}function e(b){var c={method:"get",url:common.format(l+"?$filter=id eq '{0}'",b.relId)},d=function(a){b.model.shenBaoInfo=a.data.value[0]||{},b.projectTypes=common.stringToArray(b.model.shenBaoInfo.projectType,","),b.constructionUnits=common.stringToArray(b.model.shenBaoInfo.constructionUnit,","),b.model.shenBaoInfo.projectInvestmentType==common.basicDataConfig().projectInvestmentType_SH?b.isSHInvestment=!0:b.model.shenBaoInfo.projectInvestmentType==common.basicDataConfig().projectInvestmentType_ZF&&(b.isZFInvestment=!0),b.model.shenBaoInfo.beginDate=common.formatDate(b.model.shenBaoInfo.beginDate),b.model.shenBaoInfo.endDate=common.formatDate(b.model.shenBaoInfo.endDate),b.model.shenBaoInfo.pifuJYS_date=common.formatDate(b.model.shenBaoInfo.pifuJYS_date),b.model.shenBaoInfo.pifuKXXYJBG_date=common.formatDate(b.model.shenBaoInfo.pifuKXXYJBG_date),b.model.shenBaoInfo.pifuCBSJYGS_date=common.formatDate(b.model.shenBaoInfo.pifuCBSJYGS_date),b.model.shenBaoInfo.projectInvestSum=common.toMoney(b.model.shenBaoInfo.projectInvestSum),b.model.shenBaoInfo.projectInvestAccuSum=common.toMoney(b.model.shenBaoInfo.projectInvestAccuSum),b.model.shenBaoInfo.capitalSCZ_ggys=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys),b.model.shenBaoInfo.capitalSCZ_gtzj=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj),b.model.shenBaoInfo.capitalSCZ_zxzj=common.toMoney(b.model.shenBaoInfo.capitalSCZ_zxzj),b.model.shenBaoInfo.capitalQCZ_ggys=common.toMoney(b.model.shenBaoInfo.capitalQCZ_ggys),b.model.shenBaoInfo.capitalQCZ_gtzj=common.toMoney(b.model.shenBaoInfo.capitalQCZ_gtzj),b.model.shenBaoInfo.capitalZYYS=common.toMoney(b.model.shenBaoInfo.capitalZYYS),b.model.shenBaoInfo.capitalSHTZ=common.toMoney(b.model.shenBaoInfo.capitalSHTZ),b.model.shenBaoInfo.capitalOther=common.toMoney(b.model.shenBaoInfo.capitalOther),b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear),b.model.shenBaoInfo.capitalSCZ_ggys_TheYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys_TheYear),b.model.shenBaoInfo.capitalSCZ_qita=common.toMoney(b.model.shenBaoInfo.capitalSCZ_qita),b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear),b.model.shenBaoInfo.capitalSCZ_ggys_LastYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys_LastYear),b.model.shenBaoInfo.capitalSCZ_qita_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_qita_LastTwoYear),b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear),b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear),b.model.shenBaoInfo.capitalSCZ_qita_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_qita_LastTwoYear),b.model.shenBaoInfo.apInvestSum=common.toMoney(b.model.shenBaoInfo.apInvestSum),b.capitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_zxzj)||0)+(parseFloat(b.model.shenBaoInfo.capitalQCZ_ggys)||0)+(parseFloat(b.model.shenBaoInfo.capitalQCZ_gtzj)||0)+(parseFloat(b.model.shenBaoInfo.capitalSHTZ)||0)+(parseFloat(b.model.shenBaoInfo.capitalZYYS)||0)+(parseFloat(b.model.shenBaoInfo.capitalOther)||0)},b.model.shenBaoInfo.projectShenBaoStage==common.basicDataConfig().projectShenBaoStage_nextYearPlan?(b.isYearPlan=!0,b.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_YearPlan,b.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]]):b.model.shenBaoInfo.projectShenBaoStage==common.basicDataConfig().projectShenBaoStage_projectProposal?(b.isProjectProposal=!0,b.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_projectProposal,b.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]]):b.model.shenBaoInfo.projectShenBaoStage==common.basicDataConfig().projectShenBaoStage_KXXYJBG?(b.isKXXYJBG=!0,b.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_KXXYJBG,b.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]]):b.model.shenBaoInfo.projectShenBaoStage==common.uploadFileTypeConfig().projectShenBaoStage_CBSJYGS&&(b.isCBSJYGS=!0,b.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_CBSJYGS,b.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]]),b.lastTwoYearCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear)||0)},b.lastYearCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys_LastYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear)||0)},b.theYearCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys_TheYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear)||0)},b.model.shenBaoInfo.projectShenBaoStage==common.basicDataConfig().projectShenBaoStage_nextYearPlan&&(b.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_YearPlan,b.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]],b.isYearPlan=!0)};common.http({vm:b,$http:a,httpOptions:c,success:d})}function f(b){var c={method:"put",url:j+"/"+b.taskId,data:b.model.taskRecord},d=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=o}})}})};common.http({vm:b,$http:a,httpOptions:c,success:d})}function g(b){var c={method:"get",url:common.format(j+"?$filter=id eq '{0}'",b.taskId)},d=function(a){b.task=a.data.value[0]||{},b.task&&(b.task.taskTypeDesc=common.getBasicDataDesc(b.task.taskType),b.task.isComplete&&(b.isComplete=!0))};common.http({vm:b,$http:a,httpOptions:c,success:d})}function h(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(j),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:{field:"isComplete",operator:"eq",value:!1},requestEnd:function(a){$("#todoNumber").html(a.response.count)},change:function(c){var d=b.filter();a.filters=d}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"title",title:"标题",filterable:!0,template:function(a){return common.format("<a href='#/task/todo/{1}/{2}/{3}'>{0}</a>",a.title,a.taskType,a.id,a.relId)}},{field:"unitName",title:"建设单位",width:400,filterable:!0},{field:"projectIndustry",title:"项目行业",width:200,template:function(a){return common.getBasicDataDesc(a.projectIndustry)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_ZF}).toArray(),dataTextField:"description",dataValueField:"id"})}}},{field:"taskType",title:"任务类型",width:180,filterable:!1,template:function(a){return common.getBasicDataDesc(a.taskType)}},{field:"",title:"创建日期",width:180,template:function(a){return kendo.toString(new Date(a.createdDate),"yyyy/MM/dd HH:mm:ss")}}];a.gridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function i(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(k),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},change:function(c){var d=b.filter();a.filters=d}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"title",title:"标题",filterable:!0,template:function(a){return common.format("<a href='#/task/todo/{1}/{2}/{3}'>{0}</a>",a.title,a.taskType,a.taskId,a.relId)}},{field:"unitName",title:"建设单位",width:400,filterable:!0},{field:"projectIndustry",title:"项目行业",width:200,template:function(a){return common.getBasicDataDesc(a.projectIndustry)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_ZF}).toArray(),dataTextField:"description",dataValueField:"id"})}}},{field:"taskType",title:"任务类型",width:180,filterable:!1,template:function(a){return common.getBasicDataDesc(a.taskType)}},{field:"",title:"创建日期",width:180,template:function(a){return kendo.toString(new Date(a.createdDate),"yyyy/MM/dd HH:mm:ss")}}];a.gridOptions_complete={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}var j="/management/task",k="/management/taskRecord",l="/management/shenbao",m="/management/monthReport",n="/management/project",o="#/task/todo",p={grid:h,completeGird:i,getTaskById:g,getShenBaoInfoById:e,getMonthReportById:d,handle:f};return p}angular.module("app").factory("taskSvc",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){"yearPlan_shenbaoInfoEdit"==c.current.name&&(n.page="shenbaoInfoAdd"),"yearPlan_shenbaoInfoEdit"==c.current.name&&n.id&&(n.page="shenbaoInfoEdit"),"yearPlan_planList"==c.current.name&&(n.page="planList"),"yearPlan_planEdit"==c.current.name&&(n.page="plan_create"),"yearPlan_planEdit"==c.current.name&&n.id&&(n.page="plan_update"),"yearPlan_planBZ"==c.current.name&&(n.page="planBZ"),n.checkLength=function(a,b,c){common.checkLength(a,b,c)},n.getBasicDataDesc=function(a){return common.getBasicDataDesc(a)},n.html=function(a){return e.trustAsHtml(a)},$(document).on("click","#checkboxAll_shenBaoList",function(){var a=$(this).is(":checked");$(".yearPlanCapitalGrid").find("tr td:nth-child(1)").find("input:checkbox").prop("checked",a)}),n.basicData.projectCategory=common.getBacicDataByIndectity(common.basicDataConfig().projectCategory),n.basicData.projectConstrChar=common.getBacicDataByIndectity(common.basicDataConfig().projectConstrChar),n.basicData.auditState=common.getBacicDataByIndectity(common.basicDataConfig().auditState),n.basicData.projectStage=common.getBacicDataByIndectity(common.basicDataConfig().projectStage),n.basicData.projectType=common.getBacicDataByIndectity(common.basicDataConfig().projectType),n.basicData.projectCategory=common.getBacicDataByIndectity(common.basicDataConfig().projectCategory),n.basicData.projectConstrChar=common.getBacicDataByIndectity(common.basicDataConfig().projectConstrChar),n.basicData.unitProperty=common.getBacicDataByIndectity(common.basicDataConfig().unitProperty),n.basicData.area_Street=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().area&&a.pId==common.basicDataConfig().area_GM}).toArray(),n.basicData.userUnit=common.getUserUnits()}function g(){"shenbaoInfoList"==n.page&&h(),"shenbaoInfoAdd"==n.page&&(n.shenBaoInfoAdd=!0,i()),"shenbaoInfoEdit"==n.page&&(n.shenBaoInfoEdit=!0,i()),"planList"==n.page&&j(),"plan_create"==n.page&&k(),"plan_update"==n.page&&(n.isPlanEdit=!0,l()),"planBZ"==n.page&&m(),$(document).on("click","#checkboxAll_shenBaoList",function(){var a=$(this).is(":checked");$(".yearPlanCapitalGrid").find("tr td:nth-child(1)").find("input:checkbox").prop("checked",a)})}function h(){b.grid_shenbaoInfoList(n),n.search=function(){var a=[];a.push({field:"projectShenBaoStage",operator:"eq",value:common.basicDataConfig().projectShenBaoStage_nextYearPlan}),a.push({field:"processState",operator:"eq",value:common.basicDataConfig().processState_qianShou}),null!=n.search.projectName&&""!=n.search.projectName&&a.push({field:"projectName",operator:"contains",value:n.search.projectName}),null!=n.search.projectCategory&&""!=n.search.projectCategory&&a.push({field:"projectCategory",operator:"eq",value:n.search.projectCategory}),null!=n.search.planYear&&""!=n.search.planYear&&a.push({field:"planYear",operator:"eq",value:parseInt(n.search.planYear)}),null!=n.search.constructionUnit&&""!=n.search.constructionUnit&&a.push({field:"constructionUnit",operator:"contains",value:n.search.constructionUnit}),null!=n.search.auditState&&""!=n.search.auditState&&a.push({field:"auditState",operator:"eq",value:n.search.auditState}),null!=n.search.projectConstrChar&&""!=n.search.projectConstrChar&&a.push({field:"projectConstrChar",operator:"eq",value:n.search.projectConstrChar}),n.gridOptions.dataSource.filter(a)},n.dialog_shenbaoInfo=function(a){n.id=a,b.getShenBaoInfoById(n),$("#shenbaoInfo").modal({backdrop:"static",keyboard:!1}),n.tabStripOptions={}},n.retreat=function(a){common.confirm({vm:n,msg:"确定需要退文吗？",fn:function(){$(".confirmDialog").modal("hide"),$("#shenbaoInfoTuiWen").modal({backdrop:"static",keyboard:!1}),n.model.relId=a,n.model.processState=common.basicDataConfig().processState_tuiWen,n.retreatSubmit=function(){$("#shenbaoInfoTuiWen").modal("hide"),b.updateShenBaoInfoState(n)}}})},n.addShenBaoInfo=function(){var b=common.basicDataConfig().projectInvestmentType_ZF,c=common.basicDataConfig().projectShenBaoStage_nextYearPlan;a.path("/yearPlan/shenbaoInfoEdit//"+b+"/"+c)}}function i(){n.auditState_auditPass=common.basicDataConfig().auditState_auditPass,n.auditState_auditNotPass=common.basicDataConfig().auditState_auditNotPass;var a=function(){n.isYearPlan=n.stage==common.basicDataConfig().projectShenBaoStage_nextYearPlan,n.isYearPlan&&(n.isYearPlan=!0,n.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_YearPlan,n.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]]),n.shenBaoInfoAdd&&($("#tab1").attr("disabled","true"),$("#tab2").attr("disabled","true"),$("#tab3").attr("disabled","true"),$("#tab4").attr("disabled","true"))},c=function(){n.investmentType==common.basicDataConfig().projectInvestmentType_ZF?(n.isZFInvestment=!0,n.basicData.projectClassify=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectClassify&&a.pId==common.basicDataConfig().projectClassify_ZF}).toArray(),n.basicData.projectIndustry=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_ZF}).toArray()):n.investmentType==common.basicDataConfig().projectInvestmentType_SH&&(n.isSHInvestment=!0,n.basicData.projectClassify=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectClassify&&a.pId==common.basicDataConfig().projectClassify_SH}).toArray(),n.basicData.projectIndustry=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_SH}).toArray(),n.projectIndustryChange=function(){n.basicData.projectIndustryChildren=$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==n.model.projectIndustryParent}).toArray()})};a(),c(),b.getShenBaoInfoById(n),n.unitNameChange=function(){b.getUserUnit(n)},n.updateSelection=function(a){n.projectTypes.constructor==String&&(n.projectTypes=common.stringToArray(n.projectTypes));var b=n.projectTypes.indexOf(a);b==-1?n.projectTypes.push(a):n.projectTypes.splice(b,1)},n.changeYear=function(){n.planYear=parseInt(n.model.shenBaoInfo.planYear)},n.choseDocument=function(a){n.pifuType=$(a.target).parents(".uploadBox").attr("data-type"),$("#documentRecords").modal({backdrop:"static",keyboard:!1}),n.grid_documentRecords.dataSource.read()},b.documentRecordsGird(n),n.pifuChoseConfirm=function(){$("#documentRecords").modal("hide"),$(".modal-backdrop").remove();var a=common.getKendoCheckId(".grid"),b=a[0].value;if(b){var c=common.stringToArray(b,","),d=c[0],e=c[1],f=c[2];n.model.shenBaoInfo["pifu"+n.pifuType+"_wenhao"]=d,n.model.shenBaoInfo.attachmentDtos?n.model.shenBaoInfo.attachmentDtos.push({name:e,url:f,type:n.pifuType}):n.model.shenBaoInfo.attachmentDtos=[{name:e,url:f,type:n.pifuType}]}},n.uploadSuccess=function(a){var b=$(a.sender.element).parents(".uploadBox").attr("data-type");if(200==a.XMLHttpRequest.status){var c=a.XMLHttpRequest.response;d.$apply(function(){n.model.shenBaoInfo.attachmentDtos?n.model.shenBaoInfo.attachmentDtos.push({name:c.split("_")[2],url:c,type:b}):n.model.shenBaoInfo.attachmentDtos=[{name:c.split("_")[2],url:c,type:b}]})}},n.onSelect=function(a){$.each(a.files,function(a,b){b.size>common.basicDataConfig().uploadSize&&d.$apply(function(){common.alert({vm:n,msg:"上传文件过大！"})})})},n.uploadOptions_pifu={async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},error:n.uploadSuccess,localization:{select:"上传文件"},showFileList:!1,multiple:!1,validation:{maxFileSize:common.basicDataConfig().uploadSize},select:n.onSelect},n.uploadOptions={async:{saveUrl:"/common/save",removeUrl:"/common/remove",autoUpload:!0},error:n.uploadSuccess,localization:{select:"上传文件"},showFileList:!1,multiple:!0,validation:{maxFileSize:common.basicDataConfig().uploadSize},select:n.onSelect},n.delFile=function(a){var b=n.model.shenBaoInfo.attachmentDtos[a];if(b){var c=b.type;n.model.shenBaoInfo["pifu"+c+"_wenhao"]="",n.model.shenBaoInfo.attachmentDtos.splice(a,1)}},n.tabReturn=function(a){var b=$("#tab"+a);n.tabStrip.activateTab(b)},n.tabChange=function(a){common.initJqValidation();var b=$("form").valid(),c=$("#tab"+a);b&&n.tabStrip.activateTab(c)},n.addUnit=function(){n.constructionUnits.constructor==String&&(n.constructionUnits=common.stringToArray(n.constructionUnits)),n.constructionUnits.push(""),n.constructionUnits.length>1&&(n.canDelete=!0)},n.deleteUnit=function(a){n.canDelete&&(n.constructionUnits.constructor==String&&(n.constructionUnits=common.stringToArray(n.constructionUnits)),n.constructionUnits.splice(a,1),n.constructionUnits.length<=1&&(n.canDelete=!1))},n.addProjectToLibray=function(){b.addProjectToLibrary(n)},n.updateProject=function(){b.updateProject(n)},n.update=function(){n.model.shenBaoInfo.auditState=common.basicDataConfig().auditState_noAudit,b.updateShenBaoInfo(n)},n.updateAuditState=function(a){n.isAudit=!0,n.model.shenBaoInfo.auditState=a,b.updateShenBaoInfo(n)},n.create=function(){b.createShenBaoInfo(n)}}function j(){b.grid_planList(n)}function k(){n.create=function(){b.plan_create(n)}}function l(){b.getPlanById(n),n.update=function(){b.plan_update(n)}}function m(){b.grid_yearPlan_shenbaoInfoList(n),b.grid_yearPlan_addShenbaoInfoList(n),n.dialog_addPlan=function(){$("#addPlanList").modal({backdrop:"static",keyboard:!1})},n.search=function(){var a=[];a.push({field:"projectShenBaoStage",operator:"eq",value:common.basicDataConfig().projectShenBaoStage_nextYearPlan}),a.push({field:"processState",operator:"eq",value:common.basicDataConfig().processState_qianShou}),null!=n.search.projectName&&""!=n.search.projectName&&a.push({field:"projectName",operator:"contains",value:n.search.projectName}),null!=n.search.projectCategory&&""!=n.search.projectCategory&&a.push({field:"projectCategory",operator:"eq",value:n.search.projectCategory}),null!=n.search.planYear&&""!=n.search.planYear&&a.push({field:"planYear",operator:"eq",value:parseInt(n.search.planYear)}),null!=n.search.constructionUnit&&""!=n.search.constructionUnit&&a.push({field:"constructionUnit",operator:"contains",value:n.search.constructionUnit}),null!=n.search.auditState&&""!=n.search.auditState&&a.push({field:"auditState",operator:"eq",value:n.search.auditState}),null!=n.search.projectConstrChar&&""!=n.search.projectConstrChar&&a.push({field:"projectConstrChar",operator:"eq",value:n.search.projectConstrChar}),n.addPlanGridOptions.dataSource.filter(a)},n.dialogConfirmSubmit=function(){var a=common.getKendoCheckId(".grid");if(0!=a.length){for(var c=[],d=0;d<a.length;d++)c.push(a[d].value);var e=c.join(",");$("#addPlanList").modal("toggle"),b.addShenBaoInfoconfirm(n,e)}},n.popOver=function(a,c){n.currentCapitalId=c,b.getYearPlanCapitalById(n,c),n.isPopOver=!0;var d=$(document).height()-50-230;a.pageY>d&&(a.pageY=d),n.popStyle={left:a.pageX+"px",top:a.pageY+"px"}},n.updateCapital=function(){b.updateYearPlanCapital(n)},n.removeYearPlanCapital=function(){var a=common.getKendoCheckId(".yearPlanCapitalGrid");if(0==a.length)common.alert({vm:n,msg:"请选择数据"});else{for(var c=[],d=0;d<a.length;d++)c.push(a[d].value);var e=c.join(",");b.removeYearPlanCapital(n,e)}}}var n=this;n.model={},n.basicData={},n.title="申报信息编辑",n.search={},n.id=c.params.id,n.investmentType=c.params.projectInvestmentType,n.stage=c.params.stage,n.page="shenbaoInfoList",f(),g()}angular.module("app").controller("yearPlanCtrl",a),a.$inject=["$location","yearPlanSvc","$state","$scope","$sce"]}(),function(){"use strict";function a(a,b){function c(c){common.initJqValidation();var d=$("form").valid();if(d){c.isSubmit=!0,c.model.shenBaoInfo.projectType=common.arrayToString(c.projectTypes,","),c.model.shenBaoInfo.constructionUnit=common.arrayToString(c.constructionUnits,","),c.model.shenBaoInfo.yearInvestApproval=parseFloat(c.model.shenBaoInfo.capitalAP_ggys_TheYear||0)+parseFloat(c.model.shenBaoInfo.capitalAP_gtzj_TheYear||0),c.model.shenBaoInfo.yearInvestApproval_lastYear=parseFloat(c.model.shenBaoInfo.capitalAP_ggys_LastYear||0)+parseFloat(c.model.shenBaoInfo.capitalAP_gtzj_LastYear||0),c.model.shenBaoInfo.yearInvestApproval_lastTwoYear=parseFloat(c.model.shenBaoInfo.capitalAP_ggys_LastTwoYear||0)+parseFloat(c.model.shenBaoInfo.capitalAP_gtzj_LastTwoYear||0);var e={method:"put",url:common.format(v),data:c.model.shenBaoInfo},f=function(a){common.alert({vm:c,msg:"操作成功！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),c.isSubmit=!1,c.isAudit&&b.path(B)}})};common.http({vm:c,$http:a,httpOptions:e,success:f})}else common.alert({vm:c,msg:"您填写的信息不正确,请核对后提交!"})}function d(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0,b.model.shenBaoInfo.projectType=common.arrayToString(b.projectTypes,","),b.model.shenBaoInfo.constructionUnit=common.arrayToString(b.constructionUnits,","),b.model.shenBaoInfo.applyYearInvest=common.getSum([b.model.shenBaoInfo.capitalSCZ_ggys_TheYear||0,b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear||0]),b.model.shenBaoInfo.applyYearInvest_LastYear=common.getSum([b.model.shenBaoInfo.capitalSCZ_ggys_LastYear||0,b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear||0]),b.model.shenBaoInfo.applyYearInvest_LastTwoYear=common.getSum([b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear||0,b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear||0]),b.model.shenBaoInfo.yearInvestApproval=common.getSum([b.model.shenBaoInfo.capitalAP_ggys_TheYear||0,b.model.shenBaoInfo.capitalAP_gtzj_TheYear||0]),b.model.shenBaoInfo.yearInvestApproval_lastYear=common.getSum([b.model.shenBaoInfo.capitalAP_ggys_LastYear||0,b.model.shenBaoInfo.capitalAP_gtzj_LastYear||0]),b.model.shenBaoInfo.yearInvestApproval_lastTwoYear=common.getSum([b.model.shenBaoInfo.capitalAP_ggys_LastTwoYear||0,b.model.shenBaoInfo.capitalAP_gtzj_LastTwoYear||0]);
var d={method:"post",url:common.format(v),data:b.model.shenBaoInfo},e=function(a){common.alert({vm:b,msg:"操作成功！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),b.isSubmit=!1}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}else common.alert({vm:b,msg:"您填写的信息不正确,请核对后提交!"})}function e(b){var c={method:"get",url:common.format(w+"?$filter=id eq '{0}'",b.model.shenBaoInfo.unitName)},d=function(a){b.model.shenBaoInfo.shenBaoUnitInfoDto=a.data.value[0]||{},b.model.shenBaoInfo.shenBaoUnitInfoDto&&(b.constructionUnits.splice(0,b.constructionUnits.length),b.constructionUnits.push(b.model.shenBaoInfo.shenBaoUnitInfoDto.unitName))};common.http({vm:b,$http:a,httpOptions:c,success:d})}function f(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(A),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),c=[{template:function(a){return kendo.format("<input type='radio'  relId='{0},{1},{2}' name='checkbox'/>",a.number,a.name,a.fullName)},filterable:!1,width:40,title:""},{field:"number",title:"文号",width:180,filterable:!0},{field:"name",title:"文件名",width:550,template:function(a){return common.format("<a href='/contents/upload/{1}'>{0}</a>",a.name,a.fullName)},filterable:!0}];a.gridOptions_documentRecords={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function g(b){var c={method:"post",url:common.format(v+"/addProjectToLibrary?shenbaoInfoId={0}",b.id)},d=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:c,success:d})}function h(b){b.model.shenBaoInfo.projectType=common.arrayToString(b.projectTypes,","),b.model.shenBaoInfo.constructionUnit=common.arrayToString(b.constructionUnits,",");var c={method:"put",url:common.format(v+"/updateProjectBasic"),data:b.model.shenBaoInfo},d=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide")}})}})};common.http({vm:b,$http:a,httpOptions:c,success:d})}function i(b){var c={method:"post",url:common.format(v+"/updateState"),data:b.model},d=function(a){common.alert({vm:b,msg:"操作成功！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),b.grid.dataSource.read()}})};common.http({vm:b,$http:a,httpOptions:c,success:d})}function j(b,c){var d={method:"post",url:common.format(x+"/removeCapital?planId={0}&yearPlanCapitalId={1}",b.id,c)},e=function(a){b.planGridOptions.dataSource.read()};common.http({vm:b,$http:a,httpOptions:d,success:e})}function k(b){b.model.capital.capitalSum=common.toDecimal4(parseFloat(b.model.capital.capitalSCZ_ggys||0)+parseFloat(b.model.capital.capitalSCZ_gtzj||0)+parseFloat(b.model.capital.capitalSCZ_zxzj||0)+parseFloat(b.model.capital.capitalQCZ_ggys||0)+parseFloat(b.model.capital.capitalQCZ_gtzj||0)+parseFloat(b.model.capital.capitalSHTZ||0)+parseFloat(b.model.capital.capitalZYYS||0)+parseFloat(b.model.capital.capitalOther||0));var c={method:"put",url:y,data:b.model.capital},d=function(a){o(b),$("#capitalSum_"+b.currentCapitalId).val(b.model.capital.capitalSum),b.isPopOver=!1};common.http({vm:b,$http:a,httpOptions:c,success:d})}function l(b,c){var d={method:"get",url:common.format(y+"?$filter=id eq '{0}'",c)},e=function(a){b.model.capital=a.data.value[0]||{},b.model.capital.capitalSCZ_ggys=common.toMoney(b.model.capital.capitalSCZ_ggys),b.model.capital.capitalSCZ_gtzj=common.toMoney(b.model.capital.capitalSCZ_gtzj),b.model.capital.capitalSCZ_zxzj=common.toMoney(b.model.capital.capitalSCZ_zxzj),b.model.capital.capitalQCZ_ggys=common.toMoney(b.model.capital.capitalQCZ_ggys),b.model.capital.capitalQCZ_gtzj=common.toMoney(b.model.capital.capitalQCZ_gtzj),b.model.capital.capitalSHTZ=common.toMoney(b.model.capital.capitalSHTZ),b.model.capital.capitalZYYS=common.toMoney(b.model.capital.capitalZYYS),b.model.capital.capitalOther=common.toMoney(b.model.capital.capitalOther)};common.http({vm:b,$http:a,httpOptions:d,success:e})}function m(b){var c={method:"get",url:common.format(v+"?$filter=id eq '{0}'",b.id)},d=function(a){if(b.model.shenBaoInfo=a.data.value[0]||{},b.shenBaoInfoEdit&&(b.planYear=b.model.shenBaoInfo.planYear),b.shenBaoInfoAdd){b.model.shenBaoInfo.projectInvestmentType=b.investmentType,b.model.shenBaoInfo.projectShenBaoStage=b.stage;var c=new Date;b.planYear=b.model.shenBaoInfo.planYear=parseInt(c.getFullYear()+1)}b.projectTypes=common.stringToArray(b.model.shenBaoInfo.projectType,","),b.constructionUnits=common.stringToArray(b.model.shenBaoInfo.constructionUnit,","),b.constructionUnits.length>1?b.canDelete=!0:b.canDelete=!1,b.model.shenBaoInfo.projectInvestmentType==common.basicDataConfig().projectInvestmentType_SH?b.isSHInvestment=!0:b.model.shenBaoInfo.projectInvestmentType==common.basicDataConfig().projectInvestmentType_ZF&&(b.isZFInvestment=!0),b.model.shenBaoInfo.beginDate=common.formatDate(b.model.shenBaoInfo.beginDate),b.model.shenBaoInfo.endDate=common.formatDate(b.model.shenBaoInfo.endDate),b.model.shenBaoInfo.pifuJYS_date=common.formatDate(b.model.shenBaoInfo.pifuJYS_date),b.model.shenBaoInfo.pifuKXXYJBG_date=common.formatDate(b.model.shenBaoInfo.pifuKXXYJBG_date),b.model.shenBaoInfo.pifuCBSJYGS_date=common.formatDate(b.model.shenBaoInfo.pifuCBSJYGS_date),b.model.shenBaoInfo.projectInvestSum=common.toMoney(b.model.shenBaoInfo.projectInvestSum),b.model.shenBaoInfo.projectInvestAccuSum=common.toMoney(b.model.shenBaoInfo.projectInvestAccuSum),b.model.shenBaoInfo.capitalSCZ_ggys=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys),b.model.shenBaoInfo.capitalSCZ_gtzj=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj),b.model.shenBaoInfo.capitalSCZ_zxzj=common.toMoney(b.model.shenBaoInfo.capitalSCZ_zxzj),b.model.shenBaoInfo.capitalQCZ_ggys=common.toMoney(b.model.shenBaoInfo.capitalQCZ_ggys),b.model.shenBaoInfo.capitalQCZ_gtzj=common.toMoney(b.model.shenBaoInfo.capitalQCZ_gtzj),b.model.shenBaoInfo.capitalZYYS=common.toMoney(b.model.shenBaoInfo.capitalZYYS),b.model.shenBaoInfo.capitalSHTZ=common.toMoney(b.model.shenBaoInfo.capitalSHTZ),b.model.shenBaoInfo.capitalOther=common.toMoney(b.model.shenBaoInfo.capitalOther),b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear),b.model.shenBaoInfo.capitalSCZ_ggys_TheYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys_TheYear),b.model.shenBaoInfo.capitalSCZ_qita=common.toMoney(b.model.shenBaoInfo.capitalSCZ_qita),b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear),b.model.shenBaoInfo.capitalSCZ_ggys_LastYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys_LastYear),b.model.shenBaoInfo.capitalSCZ_qita_LastYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_qita_LastYear),b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear),b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear),b.model.shenBaoInfo.capitalSCZ_qita_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalSCZ_qita_LastTwoYear),b.model.shenBaoInfo.apInvestSum=common.toMoney(b.model.shenBaoInfo.apInvestSum),b.model.shenBaoInfo.capitalAP_ggys_TheYear=common.toMoney(b.model.shenBaoInfo.capitalAP_ggys_TheYear),b.model.shenBaoInfo.capitalAP_gtzj_TheYear=common.toMoney(b.model.shenBaoInfo.capitalAP_gtzj_TheYear),b.model.shenBaoInfo.capitalAP_qita=common.toMoney(b.model.shenBaoInfo.capitalAP_qita),b.model.shenBaoInfo.capitalAP_gtzj_LastYear=common.toMoney(b.model.shenBaoInfo.capitalAP_gtzj_LastYear),b.model.shenBaoInfo.capitalAP_ggys_LastYear=common.toMoney(b.model.shenBaoInfo.capitalAP_ggys_LastYear),b.model.shenBaoInfo.capitalAP_qita_LastYear=common.toMoney(b.model.shenBaoInfo.capitalAP_qita_LastYear),b.model.shenBaoInfo.capitalAP_ggys_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalAP_ggys_LastTwoYear),b.model.shenBaoInfo.capitalAP_gtzj_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalAP_gtzj_LastTwoYear),b.model.shenBaoInfo.capitalAP_qita_LastTwoYear=common.toMoney(b.model.shenBaoInfo.capitalAP_qita_LastTwoYear),b.capitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_zxzj)||0)+(parseFloat(b.model.shenBaoInfo.capitalQCZ_ggys)||0)+(parseFloat(b.model.shenBaoInfo.capitalQCZ_gtzj)||0)+(parseFloat(b.model.shenBaoInfo.capitalSHTZ)||0)+(parseFloat(b.model.shenBaoInfo.capitalZYYS)||0)+(parseFloat(b.model.shenBaoInfo.capitalOther)||0)},b.lastTwoYearCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys_LastTwoYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj_LastTwoYear)||0)},b.lastYearCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys_LastYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj_LastYear)||0)},b.theYearCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalSCZ_ggys_TheYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalSCZ_gtzj_TheYear)||0)},b.lastTwoYearAPCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalAP_ggys_LastTwoYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalAP_gtzj_LastTwoYear)||0)},b.lastYearAPCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalAP_ggys_LastYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalAP_gtzj_LastYear)||0)},b.theYearAPCapitalTotal=function(){return(parseFloat(b.model.shenBaoInfo.capitalAP_ggys_TheYear)||0)+(parseFloat(b.model.shenBaoInfo.capitalAP_gtzj_TheYear)||0)},"shenbaoInfoList"==b.page&&b.model.shenBaoInfo.projectShenBaoStage==common.basicDataConfig().projectShenBaoStage_nextYearPlan&&(b.materialsType=common.uploadFileTypeConfig().projectShenBaoStage_YearPlan,b.uploadType=[["JYS","项目建议书"],["KXXYJBG","可行性研究报告"],["CBSJYGS","初步设计与概算"]],b.isYearPlan=!0)};common.http({vm:b,$http:a,httpOptions:c,success:d})}function n(b,c){var d={method:"get",url:common.format(x+"/addCapital?planId={0}&shenBaoId={1}",b.id,c)},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),b.planGridOptions.dataSource.read()}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}function o(b){var c={method:"get",url:common.format(x+"?$filter=id eq '{0}'",b.id)},d=function(a){if("plan_update"==b.page&&(b.model=a.data.value[0]||{}),"planBZ"==b.page){b.model.plan=a.data.value[0]||{};var c=b.model.plan.yearPlanCapitalDtos,d=b.planGridOptions.dataSource._data;b.model.shenBaoInfoTotal=d.length,b.model.QianQiTotal=0,b.model.NewStratTotal=0,b.model.XuJianTotal=0,b.model.ChuBeiTotal=0,b.model.projectInvestSumTotal=0,b.model.applyYearInvestTotal=0;for(var e=0;e<d.length;e++){var f=d[e];f.projectConstrChar&&f.projectConstrChar==common.basicDataConfig().projectConstrChar_qianqi&&b.model.QianQiTotal++,f.projectConstrChar&&f.projectConstrChar==common.basicDataConfig().projectConstrChar_xinkaigong&&b.model.NewStratTotal++,f.projectConstrChar&&f.projectConstrChar==common.basicDataConfig().projectConstrChar_xujian&&b.model.XuJianTotal++,f.projectConstrChar&&f.projectConstrChar==common.basicDataConfig().projectConstrChar_chubei&&b.model.ChuBeiTotal++,f.projectInvestSum&&(b.model.projectInvestSumTotal+=f.projectInvestSum),f.applyYearInvest&&(b.model.applyYearInvestTotal+=f.applyYearInvest)}b.model.yearInvestApprovalTotal=0,b.model.capitalSCZ_ggysTotal=0,b.model.capitalSCZ_gtzjTotal=0,b.model.capitalSCZ_zxzjTotal=0,b.model.capitalQCZ_ggysTotal=0,b.model.capitalQCZ_gtzjTotal=0,b.model.capitalZYYSTotal=0,b.model.capitalSHTZTotal=0,b.model.capitalOtherTotal=0;for(var g=0;g<c.length;g++)c[g].capitalSCZ_ggys&&(b.model.capitalSCZ_ggysTotal+=c[g].capitalSCZ_ggys),c[g].capitalSCZ_gtzj&&(b.model.capitalSCZ_gtzjTotal+=c[g].capitalSCZ_gtzj),c[g].capitalSCZ_zxzj&&(b.model.capitalSCZ_zxzjTotal+=c[g].capitalSCZ_zxzj),c[g].capitalQCZ_ggys&&(b.model.capitalQCZ_ggysTotal+=c[g].capitalQCZ_ggys),c[g].capitalQCZ_gtzj&&(b.model.capitalQCZ_gtzjTotal+=c[g].capitalQCZ_gtzj),c[g].capitalZYYS&&(b.model.capitalZYYSTotal+=c[g].capitalZYYS),c[g].capitalSHTZ&&(b.model.capitalSHTZTotal+=c[g].capitalSHTZ),c[g].capitalOther&&(b.model.capitalOtherTotal+=c[g].capitalOther),c[g].capitalSum&&(b.model.yearInvestApprovalTotal+=c[g].capitalSum)}};common.http({vm:b,$http:a,httpOptions:c,success:d})}function p(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(x+"/"+a.id+"/projectList"),schema:common.kendoGridConfig().schema({id:"yearPlanCapitalId"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:1e3,sort:{field:"createdDate",dir:"desc"},requestEnd:function(){o(a)}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll_shenBaoList' type='checkbox'  class='checkbox'/>"},{field:"constructionUnit",title:"建设单位",width:120,filterable:!1},{field:"projectName",title:"项目名称",template:function(a){return common.format('<a href="#/projectDetails/{0}/{1}" >{2}</a>',a.projectId,a.projectInvestmentType,a.projectName)},width:200,filterable:!1},{field:"functionSubjects",title:"功能科目",width:110,filterable:!1},{field:"econClassSubjects",title:"经济分类科目",width:140,filterable:!1},{field:"projectIndustryDesc",title:"行业领域",template:function(a){return common.getBasicDataDesc(a.projectIndustry)},width:100,filterable:!1},{field:"projectCategoryDesc",title:"项目类别",width:80,template:function(a){return common.getBasicDataDesc(a.projectCategory)},filterable:!1},{field:"projectConstrCharDesc",title:"建设性质",template:function(a){return common.getBasicDataDesc(a.projectConstrChar)},width:80,filterable:!1},{field:"beginDate",title:"开工/竣工时间",width:100,template:function(a){return a.projectCategory==common.basicDataConfig().projectCategory_A?common.formatDate(a.endDate)||"":a.projectCategory==common.basicDataConfig().projectCategory_B||a.projectCategory==common.basicDataConfig().projectCategory_C||a.projectCategory==common.basicDataConfig().projectCategory_D?common.formatDate(a.beginDate)||"":void 0},filterable:!1},{field:"projectGuiMo",title:"建设规模及主要建设内容",width:200,template:function(a){return common.format('<span style="text-overflow:ellipsis;width:120px;overflow:hidden;white-space:nowrap;" title="{0}">{0}</span>',a.projectGuiMo||"")},filterable:!1},{field:"projectInvestSum",title:"总投资（万元）",width:120,filterable:!1},{field:"projectInvestAccuSum",title:"已拨付资金（万元）",width:145,filterable:!1},{field:"planYear",title:"计划年度",width:100,filterable:!1},{field:"yearConstructionContent",title:"本年度建设内容",width:120,template:function(a){return common.format('<span style="text-overflow:ellipsis;width:120px;overflow:hidden;white-space:nowrap;" title="{0}">{0}</span>',a.yearConstructionContent||"")},filterable:!1},{field:"capitalSCZ_ggys_TheYear",title:"资金需求及资金来源--公共预算（万元）",width:100,filterable:!1},{field:"capitalSCZ_gtzj_TheYear",title:"资金需求及资金来源--国土基金（万元）",width:100,filterable:!1},{field:"capitalSCZ_qita",title:"资金需求及资金来源--其他（万元）",width:100,filterable:!1},{field:"planYear+1",title:"计划年度",width:100,filterable:!1},{field:"yearConstructionContentLastYear",title:"本年度建设内容",width:120,template:function(a){return common.format('<span style="text-overflow:ellipsis;width:120px;overflow:hidden;white-space:nowrap;" title="{0}">{0}</span>',a.yearConstructionContentLastYear||"")},filterable:!1},{field:"capitalSCZ_ggys_LastYear",title:"资金需求及资金来源--公共预算（万元）",width:100,filterable:!1},{field:"capitalSCZ_gtzj_LastYear",title:"资金需求及资金来源--国土基金（万元）",width:100,filterable:!1},{field:"capitalSCZ_qita_LastYear",title:"资金需求及资金来源--其他（万元）",width:100,filterable:!1},{field:"planYear+2",title:"计划年度",width:100,filterable:!1},{field:"yearConstructionContentLastTwoYear",title:"本年度建设内容",width:120,template:function(a){return common.format('<span style="text-overflow:ellipsis;width:120px;overflow:hidden;white-space:nowrap;" title="{0}">{0}</span>',a.yearConstructionContentLastTwoYear||"")},filterable:!1},{field:"capitalSCZ_ggys_LastTwoYear",title:"资金需求及资金来源--公共预算（万元）",width:100,filterable:!1},{field:"capitalSCZ_gtzj_LastTwoYear",title:"资金需求及资金来源--国土基金（万元）",width:100,filterable:!1},{field:"capitalSCZ_qita_LastTwoYear",title:"资金需求及资金来源--其他（万元）",width:100,filterable:!1},{field:"yearInvestApproval",title:"安排资金（万元）",template:function(a){return common.format($("#input").html(),a.id,a.yearInvestApproval||0)},width:130,filterable:!1},{field:"yearConstructionContentShenBao",title:"备注",width:150,template:function(a){return common.format('<span style="text-overflow:ellipsis;width:10px;overflow:hidden;white-space:nowrap;" title="{0}">{0}</span>',a.yearConstructionContentShenBao||"")},filterable:!1}],d=function(a){for(var b=a.data,c=a.workbook.sheets[0],d=this.columns[8].template,e=0;e<b.length;e++){var f=d(b[e]),g=c.rows[e+1];g.cells[7].value=f}};a.planGridOptions={excel:{fileName:"年度计划编制.xlsx"},dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0,excelExport:d}}function q(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(v),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:[{field:"projectShenBaoStage",operator:"eq",value:common.basicDataConfig().projectShenBaoStage_nextYearPlan},{field:"processState",operator:"eq",value:common.basicDataConfig().processState_qianShou},{field:"auditState",operator:"eq",value:common.basicDataConfig().auditState_auditPass}]}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"planYear",title:"计划年度",width:150,filterable:!1},{field:"projectName",title:"项目名称",width:200,filterable:!0},{field:"constructionUnit",title:"建设单位",width:200,filterable:!0},{field:"projectConstrChar",title:"建设性质",width:150,template:function(a){return common.getBasicDataDesc(a.projectConstrChar)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().projectConstrChar),dataTextField:"description",dataValueField:"id"})}}},{field:"projectClassifyDesc",title:"项目分类",template:function(a){return common.getBasicDataDesc(a.projectClassify)},width:150,filterable:!1},{field:"projectInvestSum",title:"总投资（万元）",width:150,filterable:!1},{field:"applyYearInvest",title:"申请年度投资（万元）",width:150,filterable:!1},{field:"createdDate",title:"创建日期",width:180,filterable:!1,template:function(a){return common.formatDateTime(a.createdDate)}}];a.addPlanGridOptions={dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function r(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0;var d={method:"post",url:x,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=z}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}}function s(b){common.initJqValidation();var c=$("form").valid();if(c){b.isSubmit=!0;var d={method:"put",url:x,data:b.model},e=function(a){common.requestSuccess({vm:b,response:a,fn:function(){common.alert({vm:b,msg:"操作成功",fn:function(){b.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=z}})}})};common.http({vm:b,$http:a,httpOptions:d,success:e})}}function t(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(x),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"name",title:"编制名称",filterable:!0},{field:"year",title:"计划年度",width:150,filterable:!1},{field:"createdDate",title:"创建日期",width:180,filterable:!1,template:function(a){return kendo.toString(new Date(a.createdDate),"yyyy/MM/dd HH:mm:ss")}},{field:"",title:"操作",width:180,template:function(a){return common.format($("#columnBtns").html(),a.id,a.projectInvestmentType,a.projectShenBaoStage)}}];a.gridOptions={excel:{fileName:"年度计划项目库.xlsx"},dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,resizable:!0}}function u(a){var b=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(v),schema:common.kendoGridConfig().schema({id:"id",fields:{isIncludLibrary:{type:"boolean"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"},filter:[{field:"projectShenBaoStage",operator:"eq",value:common.basicDataConfig().projectShenBaoStage_nextYearPlan},{field:"processState",operator:"eq",value:common.basicDataConfig().processState_qianShou}]}),c=[{template:function(a){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox'/>",a.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'/>"},{field:"projectName",title:"项目名称",template:function(a){return common.format("<a href='javascript:void(0)' ng-click='vm.dialog_shenbaoInfo(\"{0}\")'>{1}</a>",a.id,a.projectName)},width:200,filterable:!0},{field:"constructionUnit",title:"建设单位",width:200,filterable:!0},{field:"projectConstrChar",title:"建设性质",width:100,template:function(a){return common.getBasicDataDesc(a.projectConstrChar)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().projectConstrChar),dataTextField:"description",dataValueField:"id"})}}},{field:"projectCategory",title:"项目类别",width:100,template:function(a){return common.getBasicDataDesc(a.projectCategory)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().projectCategory),dataTextField:"description",dataValueField:"id"})}}},{field:"projectIndustry",title:"项目行业",width:100,template:function(a){return common.getBasicDataDesc(a.projectIndustry)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:$linq(common.getBasicData()).where(function(a){return a.identity==common.basicDataConfig().projectIndustry&&a.pId==common.basicDataConfig().projectIndustry_ZF}).toArray(),dataTextField:"description",dataValueField:"id"})}}},{field:"planYear",title:"计划年度",width:100,filterable:!1},{field:"auditState",title:"审核状态",width:100,template:function(a){return common.getBasicDataDesc(a.auditState)},filterable:{ui:function(a){a.kendoDropDownList({valuePrimitive:!0,dataSource:common.getBacicDataByIndectity(common.basicDataConfig().auditState),dataTextField:"description",dataValueField:"id"})}}},{field:"createdDate",title:"创建日期",width:180,filterable:!1,template:function(a){return common.formatDateTime(a.createdDate)}},{filed:"",title:"操作",width:150,template:function(a){return common.format($("#columnBtns").html(),a.id,a.projectInvestmentType,a.projectShenBaoStage)}}],d=function(a){for(var b=a.workbook.sheets[0],c=1;c<b.rows.length;c++){var d=b.rows[c];d.cells[2].value=common.getBasicDataDesc(d.cells[2].value),d.cells[3].value=common.getBasicDataDesc(d.cells[3].value),d.cells[4].value=common.getBasicDataDesc(d.cells[4].value),d.cells[6].value=common.getBasicDataDesc(d.cells[6].value),d.cells[7].value=common.formatDateTime(d.cells[7].value)}};a.gridOptions={excel:{fileName:"年度计划项目库.xlsx"},dataSource:common.gridDataSource(b),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c,excelExport:d,resizable:!0}}var v="/management/shenbao",w="/management/userUnit",x="/management/yearPlan",y="/management/yearPlanCapital",z="#/yearPlan/planList",A="/management/replyFile",B="/yearPlan/shenbaoInfoList",C={grid_shenbaoInfoList:u,updateShenBaoInfoState:i,addProjectToLibrary:g,updateShenBaoInfo:c,createShenBaoInfo:d,updateProject:h,grid_planList:t,plan_create:r,plan_update:s,getPlanById:o,grid_yearPlan_shenbaoInfoList:p,grid_yearPlan_addShenbaoInfoList:q,addShenBaoInfoconfirm:n,getShenBaoInfoById:m,getYearPlanCapitalById:l,updateYearPlanCapital:k,removeYearPlanCapital:j,documentRecordsGird:f,getUserUnit:e};return C}angular.module("app").factory("yearPlanSvc",a),a.$inject=["$http","$location"]}();