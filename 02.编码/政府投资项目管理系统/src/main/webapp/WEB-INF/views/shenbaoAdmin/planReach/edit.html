<div class="well well-sm" style="background:white;">
  <ol class="breadcrumb">
	  <li style="color:#0b8d39;padding-left:15px;"> 当前位置：</li>
	  <li><a href="#/managerCenter">首页</a></li>
      <li><a class="text-primary" href="javascript:;" ui-sref="planReach">计划下达</a></li>	 
      <li class="active">{{vm.title}}</li>
  </ol>
  <div class="toolbar">
  	<a class="btn btn-success btn-sm" href="javascript:;" ui-sref="planReach"><span class="glyphicon glyphicon-chevron-left"></span>&nbsp;返回</a>
  	<button ng-if="!vm.id" type="button" class="btn btn-success btn-sm" ng-click="vm.addApplication()" ng-disabled="vm.isSubmit"><span class="glyphicon glyphicon-ok"></span>&nbsp;创建</button>
 	<button ng-if="vm.id" type="button" class="btn btn-success btn-sm" ng-click="vm.editApplication()" ng-disabled="vm.isSubmit"><span class="glyphicon glyphicon-ok"></span>&nbsp;更新</button>
  </div>
  
  <div>
  	<form id="form" name="form">
  		<table class="table table-striped table-bordered">
  			<tr>
  				<td class="formAlignRight">标题：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="form-control input-sm" id="applicationName" name="applicationName" ng-model="vm.model.applicationName" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="applicationName" data-valmsg-replace="true" class="required"></span>
  				</td>
  				<td class="formAlignRight">申报单位：</td>
  				<td ng-bind="vm.userUnit.unitName"></td>
  			</tr>
  			<tr>
  				<td class="formAlignRight">负责人：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="form-control input-sm" id="resPerson" name="resPerson" ng-model="vm.model.resPerson" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="resPerson" data-valmsg-replace="true" class="required"></span>
  				</td>
  				<td class="formAlignRight">负责人电话：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="form-control input-sm" id="resPersonTel" name="resPersonTel" ng-model="vm.model.resPersonTel" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="resPersonTel" data-valmsg-replace="true" class="required"></span>
  				</td>
  			</tr>
  			<tr>
  				<td class="formAlignRight">申请时间：<span class="required">(*)</span></td>
  				<td colspan="3">
  					<input type="text" class="Wdate form-control input-sm" style="width:180px;" ng-model="vm.model.applicationTime" id="applicationTime" name="applicationTime"
								onClick="WdatePicker({isShowClear:false,readOnly:false,dateFmt:'yyyy-MM-dd',onpicked: function(){$(this).trigger('change')}})" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="applicationTime" data-valmsg-replace="true" class="required"></span>
  				</td>
  			</tr>
  			<tr>
  				<td class="formAlignRight" style="vertical-align: middle;">项目信息：</td>
  				<td colspan="3">
  					<table class="table table-striped table-bordered" style="margin-bottom:0">
  						<tr>
  							<td class="text-center" colspan="9">
  								<p>
  									<strong style="font-size:1.2em">申请项目</strong>
  								</p>
  							</td>
  						</tr>
  						<tbody class="text-center">
  							<tr>
  								<td rowspan="2" style="width:250px;">项目名称</td>
  								<td rowspan="2">项目总投资</td>
  								<td colspan="2">安排资金(万元)</td>
  								<td colspan="2">申请资金(万元)</td>
  								<td rowspan="2">审批阶段</td>
  								<td rowspan="2">审批状态</td>
  								<td rowspan="2"><button type="button" class="btn btn-success btn-sm" ng-click="vm.addProject()"><span class="glyphicon glyphicon-plus"></span>&nbsp;添加</button></td>
  							</tr>
  							<tr>
  								<td>公共预算</td>
  								<td>国土资金</td>
  								<td>公共预算</td>
  								<td>国土资金</td>
  							</tr>
  							<tr ng-repeat="x in vm.model.shenBaoInfoDtos">
	  							<td ng-bind="x.projectName"></td>
	  							<td ng-bind="x.projectInvestSum"></td>
	  							<td ng-bind="x.capitalAP_ggys_TheYear"></td>
	  							<td ng-bind="x.capitalAP_gtzj_TheYear"></td>
	  							<td>
	  								<input ng-if="x.isIncludYearPlan" style="width:120px" type="number" min="0" max="{{x.capitalAP_ggys_TheYear}}" step="any" id="ggys_{{x.projectNumber}}" ng-model="x.sqPlanReach_ggys" ng-keyup="vm.checkNum_ggys(x.projectNumber,x.capitalAP_ggys_TheYear)"/>
	  								<input ng-if="!x.isIncludYearPlan" style="width:120px" type="number" min="0" step="any" ng-model="x.sqPlanReach_ggys"/>
	  							</td>
	  							<td>
	  								<input ng-if="x.isIncludYearPlan" style="width:120px" type="number" min="0" max="{{x.capitalAP_gtzj_TheYear}}" step="any" id="gtzj_{{x.projectNumber}}" ng-model="x.sqPlanReach_gtzj" ng-keyup="vm.checkNum_gtzj(x.projectNumber,x.capitalAP_gtzj_TheYear)"/>
	  								<input ng-if="!x.isIncludYearPlan" style="width:120px" type="number" min="0" step="any" ng-model="x.sqPlanReach_gtzj"/>
	  							</td>
	  							<td ng-bind="vm.getBasicDataDesc(x.processStage)"></td>
	  							<td ng-bind="vm.getProcessStateDesc(x.processState)"></td>
	  							<td>
	  								<button type="button" class="btn btn-danger btn-xs" ng-click="vm.removeProject($index)" ng-disabled="!(x.processStage==vm.processStage_tianbao||x.processState==vm.processState_notPass
						||(x.processStage==vm.processStage_qianshou && x.processState != vm.processState_pass))"><span class="glyphicon glyphicon-remove"></span>&nbsp;移除</button>
	  							</td>
  							</tr>
  						</tbody>
  					</table>
  				</td>
  			</tr>
  		</table>
  		 <!--项目申报记录模态框 -->
	<div class="modal fade" id="myModal" role="dialog"> 
		<div class="modal-dialog" style="width:800px;"> 
			<div class="modal-content"> 
				<div class="modal-header bg-primary">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;	</button>  			
					<h4 class="modal-title" id="myModalLabel">项目数据</h4> 
				</div> 
				<div class="modal-body">
					<script type="text/template" id="columnBtn_projects">
						<button class="btn btn-xs btn-success" ng-click="vm.confirmProject('{0}','{1}',{2},{3},'{4}')">添加</button>
					</script>
					<div class="toolbar">
						<button class="btn btn-sm btn-success" ng-click="vm.confirmProjects()">批量添加</button>
					</div>
					<div class="projectsGrid" kendo-grid="vm.projectsGrid" k-options="vm.gridOptions_project"></div>			
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default btn-sm" data-dismiss="modal">关闭</button>	
				</div> 
			</div>
		</div>
	</div>
  	</form>
  </div> 
	
</div>

<div ng-include src="'/contents/common/dialog-confirm.tmpl.html'"></div>
<div ng-include src="'/contents/common/dialog-alert.tmpl.html'"></div>