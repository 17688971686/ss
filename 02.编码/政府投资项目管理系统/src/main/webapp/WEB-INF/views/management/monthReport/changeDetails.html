<style>
.formAlignRight{
font-weight: bold;
}
.table-bordered>thead>tr>th, 
.table-bordered>tbody>tr>th, 
.table-bordered>tfoot>tr>th, 
.table-bordered>thead>tr>td, 
.table-bordered>tbody>tr>td, 
.table-bordered>tfoot>tr>td {
    border: 1px solid #ddd;
    vertical-align: middle;
}

.title{
padding:5px;
font-weight: bold;
}
.uploadBox .k-upload-status {
	display: none;
}

.uploadBox .k-header {
	background: transparent;
	border: 0px;
}

.uploadBox em {
	display: none;
}

.uploadBox .k-dropzone {
	padding: 0px;
	margin: 0px;
}
.uploadBox .k-upload-files{
display:none;
}
</style>
<div ng-include src="'/contents/common/dialog-alert.tmpl.html'"></div>
<div class="well well-sm" style="background:white;">
    <ol class="breadcrumb">
    	<li style="color:#0b8d39;padding-left:15px;"> 当前位置：</li>
        <li>项目进度管理</li>       
        <li ><a href="#/monthReport">月报</a></li>
        <li class="active">修改</li>
    </ol>
   
	<form id="form" name="form"> 
		<div class="bg-info text-info title">项目名称</div>
		<table class="table  table-bordered table-striped">				
			<tr>
				<td width="15%">项目名称：</td>
				<td width="35%"><span ng-bind="vm.model.projectInfo.projectName"></span>
				</td>
				<td width="15%">填报月份：</td>
				<td width="80px;"><span ng-bind="vm.month"></span> 月 份</td>
			</tr>
		</table>
		<div class="bg-info text-info title">项目联系人信息</div>	
		<table class="table table-bordered table-striped">
			<tr>
				<td width="15%">填报人姓名：<span class="required">(*)</span></td>				
				<td width="35%">
				<input type="text" class="form-control input-sm" style="width:200px;" ng-model="vm.model.monthReport.fillName"
				id="fillName" name="fillName" data-val="true" data-val-required="必填">					
				</td>					
				<td width="15%">填报人手机：<span class="required">(*)</span></td>
				
				<td width="35%" >
					<input type="text" class="form-control input-sm" style="width:200px;" ng-model="vm.model.monthReport.fillMobile"
					id="fillMobile" name="fillMobile"  data-val="true" data-val-required="必填" placeholder="填写固话或手机号"
					data-val-regex="号码不合理！" data-val-regex-pattern="^((0\d{2,3}-\d{7,8})|(\d{7,8})|(1[3|4|5|8][0-9]\d{4,8}))$"/>
					<span data-valmsg-for="fillMobile" data-valmsg-replace="true" class="required"></span>	
				</td>
			</tr>
			<tr>
				<td>项目负责人：</td>
				<td>
					<input type="text" class="form-control input-sm" style="width:200px;" ng-model="vm.model.monthReport.projectRepName"
					id="projectRepName" name="projectRepName">	
				</td>
				<td>项目负责人电话：</td>
				<td>
					<input type="text" class="form-control input-sm" style="width:200px;" ng-model="vm.model.monthReport.projectRepMobile"
					id="projectRepMobile" name="projectRepMobile"  data-val="true" data-val-required="必填" placeholder="填写固话或手机号"
					data-val-regex="号码不合理！" data-val-regex-pattern="^((0\d{2,3}-\d{7,8})|(\d{7,8})|(1[3|4|5|8][0-9]\d{4,8}))$"/>
					<span data-valmsg-for="projectRepMobile" data-valmsg-replace="true" class="required"></span>
				</td>
			</tr>
		</table>
	<div class="bg-info text-info title">项目进度信息</div>	
		<table class="table  table-bordered table-striped">
			<tr>
				<td width="15%">开工日期：<span class="required">(*)</span></td>
				<td width="35%">
					<input type="text" id="beginDate" name="beginDate" onkeydown="return false;"
				 	ng-model="vm.model.monthReport.beginDate" kendo-date-picker k-format="'yyyy-MM-dd'" k-culture="'zh-CN'"/>
				 	<span data-valmsg-for="beginDate" data-valmsg-replace="true" class="required"></span>
				</td>					
				<td width="15%">竣工日期：<span class="required">(*)</span></td>				
				<td width="35%">
					<input type="text" id="endDate" name="c" onkeydown="return false;"
				 	ng-model="vm.model.monthReport.endDate" kendo-date-picker k-format="'yyyy-MM-dd'" k-culture="'zh-CN'"/>
				 	<span data-valmsg-for="endDate" data-valmsg-replace="true" class="required"></span>
				</td>				
			</tr>
			 <tr>
				<td>项目总投资：<span class="required">(*)</span></td>				
				<td>
					<input type="number" style="width:100px" class="form-control input-sm" id="invertPlanTotal" name="invertPlanTotal" ng-model="vm.model.monthReport.invertPlanTotal" data-val="true" data-val-required="必填"/> (万元)
					<span data-valmsg-for="invertPlanTotal" data-valmsg-replace="true" class="required"></span>					
				</td>
				<td>截止上年底累计下达计划：<span class="required">(*)</span></td>
				<td>
					<input type="number" style="width:100px" class="form-control input-sm" id="releasePlanTotal" name="releasePlanTotal" ng-model="vm.model.monthReport.releasePlanTotal" data-val="true" data-val-required="必填"/> (万元)
					<span data-valmsg-for="releasePlanTotal" data-valmsg-replace="true" class="required"></span>	
				</td>
			</tr>
			<tr>
				<td>本年度安排计划：<span class="required">(*)</span>
				</td>
				<td>
					<input type="number" style="width:100px" class="form-control input-sm" id="thisYearPlanInvestment" name="thisYearPlanInvestment" ng-model="vm.model.monthReport.thisYearPlanInvestment" data-val="true" data-val-required="必填"/> (万元)
					<span data-valmsg-for="thisYearPlanInvestment" data-valmsg-replace="true" class="required"></span>					
				</td>
				<td>本年度已下达计划：<span class="required">(*)</span>
				</td>
				<td>
					<input type="number" style="width:100px" class="form-control input-sm" id="thisYearPlanHasInvestment" name="thisYearPlanHasInvestment" ng-model="vm.model.monthReport.thisYearPlanHasInvestment" data-val="true" data-val-required="必填"/> (万元)
					<span data-valmsg-for="thisYearPlanHasInvestment" data-valmsg-replace="true" class="required"></span>					
				</td>
			</tr>	
			<tr>
				<td>累计完成投资：</td>
				<td colspan="3">
					<input type="number" style="width:100px" class="form-control input-sm" id="actuallyFinishiInvestment" name="actuallyFinishiInvestment" ng-model="vm.model.monthReport.actuallyFinishiInvestment" data-val="true" data-val-required="必填"/> (万元)
					<span data-valmsg-for="actuallyFinishiInvestment" data-valmsg-replace="true" class="required"></span>
				</td>
			</tr>				
			<tr>
				 <td>本月计划完成投资：<span class="required">(*)</span></td>
				<td>
					<input type="number" class="form-control input-sm" style="width:200px;" id="thisMonthPlanInvestTotal" name="thisMonthPlanInvestTotal"
					ng-model="vm.model.monthReport.thisMonthPlanInvestTotal" data-val="true" data-val-required="必填"/>&nbsp;（万元）
					<span data-valmsg-for="thisMonthPlanInvestTotal" data-valmsg-replace="true" class="required"></span>
				</td>
				<td>本月已完成投资：<span class="required">(*)</span></td>
				<td>
					<input type="number" class="form-control input-sm" style="width:200px;" id="thisMonthInvestTotal" name="thisMonthInvestTotal"
					ng-model="vm.model.monthReport.thisMonthInvestTotal" data-val="true" data-val-required="必填"/>&nbsp;（万元）
					<span data-valmsg-for="thisMonthInvestTotal" data-valmsg-replace="true" class="required"></span>
				</td>
			</tr> 
			<tr>					
				<td>是否完成竣工决算</td>
				<td colspan="3">
					<span class="radioList_text"> 
						<label><input type="radio" name="isCompletion" ng-model="vm.model.monthReport.isCompletion" value="1">是</label>									
						<label><input type="radio" name="isCompletion" ng-model="vm.model.monthReport.isCompletion" value="0" >否</label>				
					</span>
				</td>
			</tr>
			<tr>
				<td rowspan="5">进度安排<span class="required">(*)</span>
				</td>
				<td colspan="3">
					<select id="selfReview" name="selfReview" style="height:30px;" ng-model="vm.model.monthReport.selfReview"
						class="form-select" data-val="true" data-val-required="必选">
							<option value="">---请选择---</option>
							<option ng-repeat="y in vm.basicData_projectProgress"
								value="{{y.id}}">{{y.description}}</option>
					</select>
					<span data-valmsg-for="selfReview" data-valmsg-replace="true" class="required"></span>
				</td>			
			</tr>
			<tr>
				<td colspan="3">
					<p>
						预计1到3月份完成投资（万元）：
						<input type="number" id="firstQuarCompInvestment"
					ng-model="vm.model.monthReport.firstQuarCompInvestment" class="form-control input-sm "
					style="width: 80px; height: 28px">					 
					</p>
					
				</td>
			</tr>
			<tr>
				<td colspan="3">
					<p>
						预计1到6月份完成投资（万元）： <input type="number" id="secondQuarCompInvestment"
					ng-model="vm.model.monthReport.secondQuarCompInvestment" class="form-control input-sm "
					style="width: 80px; height: 28px">
					</p>
					
				</td>
			</tr>
			<tr>
				<td colspan="3">
					<p>
						预计1到9月份完成投资（万元）： <input type="number" id="thirdQuarCompInvestment"
					ng-model="vm.model.monthReport.thirdQuarCompInvestment" class="form-control input-sm "
					style="width: 80px; height: 28px">
					</p>
					
				</td>
			</tr>
			<tr>
				<td colspan="3">
					<p>
						预计1到12月份完成投资（万元）： <input type="number" id="fourthQuarCompInvestment"
					ng-model="vm.model.monthReport.fourthQuarCompInvestment" class="form-control input-sm "
					style="width: 80px; height: 28px">
					</p>
					
				</td>
			</tr>
			<tr>
				<td style="line-height: 18px">年度工作目标：<span class="required">(*)</span>
				</td>
				<td colspan="3" style="padding: 10px;">
					<textarea id="workTargets" name="workTargets" ng-model="vm.model.monthReport.workTargets"
						rows="3" cols="20"
						mark_maxlength="200"
						mark_tip="您还可以输入<font size='5'>{0}</font>个字符！"
						data-validation-placeholder="年度工作目标(200字符以内)"
						placeholder="年度工作目标(200字符以内)"
						style="height: 120px; width: 99%;" data-val="true" data-val-required="必填"></textarea>
					<span data-valmsg-for="workTargets" data-valmsg-replace="true" class="required"></span>
				</tr>
			<tr>
				<td>项目审批进度：</td>
				<td colspan="3" style="padding: 10px;"> 
					<textarea id="projectApprovalProgress" name="projectApprovalProgress" ng-model="vm.model.monthReport.projectApprovalProgress"
						rows="3" cols="20"
						mark_maxlength="200"
						mark_tip="您还可以输入<font size='5'>{0}</font>个字符！"
						data-validation-placeholder="填写项目涉及到的选址、用地、规划、消防、人防、环评、项目建议书、可行性研究报告、概算等重要审批环节的审批进度。"
						placeholder="填写项目涉及到的选址、用地、规划、消防、人防、环评、项目建议书、可行性研究报告、概算等重要审批环节的审批进度。"
						style="height: 120px; width: 99%;" data-val="true" data-val-required="必填"></textarea>
				</tr>
			<tr>
				<td style="line-height: 18px">工程形象进度或<br>项目进度情况：<span
					class="required">(*)</span>

				</td>
				<td colspan="3" style="padding: 10px;">
					<textarea id="projectImageProgress" name="projectImageProgress" ng-model="vm.model.monthReport.projectImageProgress" 
					rows="3"
					cols="20" mark_maxlength="200"
					mark_tip="您还可以输入<font size='5'>{0}</font>个字符！"
					data-validation-placeholder="工程形象进度或项目进度情况(200字符以内)"
					placeholder="工程形象进度或项目进度情况(200字符以内)"
					style="height: 120px; width: 99%; color: rgb(169, 169, 169);" data-val="true" data-val-required="必填"></textarea>
					<span data-valmsg-for="projectImageProgress" data-valmsg-replace="true" class="required"></span>
				</td>
			</tr>					
			
		</table>
		
	<div class="bg-info text-info title">问题与备注</div>
		<table class="table  table-bordered table-striped">
			<tr>
				<td style="width:180px;">项目存在问题：</td>
				<td colspan="3" style="padding:5px;">
					<table class="table  table-bordered table-striped" >
						<tbody>
							<tr class="bg-info" style="font-weight:bold">
								<td style="width:50px;">序号</td>
								<td>问题简介</td>
								<td>解决措施及建议</td>
								<td><input class="btn btn-success btn-xs" type="button"
							ng-click="vm.createProblem()" value="添加问题"></td>
							</tr>
							<tr ng-repeat="x in vm.model.monthReport.monthReportProblemDtos">
								<td><span>{{$index+1}}</span></td>
								<td><textarea style='height: 102px; width: 99%;'
								placeholder='填写项目所存在的问题。'
								data-validation-placeholder='填写项目所存在的问题。' cols='20' rows='2' ng-model="vm.model.monthReport.monthReportProblemDtos[$index].problemIntroduction"></textarea>
						</td>
						<td><textarea style='height: 102px; width: 99%;'
								placeholder='填写项目所存在的问题。'
								data-validation-placeholder='填写项目所存在的问题。' cols='20' rows='2' ng-model="vm.model.monthReport.monthReportProblemDtos[$index].solutionsAndSuggest"></textarea>
						</td>
						<td><input class='btn btn-xs btn-danger' type='button'
							ng-click='vm.deleteProblem($index)' value='删除问题' /></td>
							</tr>
						</tbody>
					</table>
				</td>
			</tr>
			<tr>
				<td>备注：</td>
				<td colspan="3" ng-bind="vm.model.monthReport.remark">				
			</tr>
		</table>
		
	<div class="bg-info text-info title">文件上传</div>
		<div style="display: block;">
		<span style="padding: 10px 15px; line-height: 24px; display: inline-block; color: #09F;">
							注意：请严格按照以下附件类型上传正确的文件<br>
							允许上传的文件类型：图片(.jpg,.gif,.png)<br>
		</span>
		<table style="width:100%;" class="table table-striped table-bordered ">					
			<tbody>
				<tr>
					<td>						
						<table style="width: 98%;" class="table table-bordered table-striped">									
							<tbody>
								<tr>
									<th width="10%" align="center" scope="col">附件类型</th>
									<th width="10%" align="center" scope="col">附件上传</th>
									<th width="30%" align="center" scope="col">附件名称</th>	
								</tr>
								<tr ng-repeat="x in vm.uploadType">
									<td rowspan="1"><span>{{x[1]}}</span></td>
									<td rowspan="1">
										<div class="uploadBox"  data-type="{{x[0]}}">
										  <input name="files"
							                   type="file"
							                   kendo-upload
							                   k-async="{saveUrl:'/common/save',removeUrl:'/common/remove',autoUpload:true}"
							                   k-error="vm.uploadSuccess"
							                   k-localization="{select:'上传文件'}"
							                   k-showFileList="false"
							                   />
										</div>
									</td>
									<td >
									 <div style="margin:3px;" 
									 	  ng-repeat="y in vm.model.monthReport.attachmentDtos" 
									 	  ng-show="y.type=='{{x[0]}}'"
									 		>
										 <a href="/contents/upload/{{y.url}}" target="_blank" ng-bind="y.name"></a>
										<button class="btn btn-xs btn-danger" ng-click="vm.delFile($index)">删除</button>
									 </div>
									
									</td>						
								</tr>
							</tbody>
						</table>
					</td>
				</tr>						
			</tbody>
		</table>
		</div>
		</form>
	<div style="text-align: center">
		<button class="btn btn-success" ng-disabled="vm.model.isSubmit || vm.model.isReportExist" ng-click="vm.submit()">确认修改</button>
	</div>
</div>
