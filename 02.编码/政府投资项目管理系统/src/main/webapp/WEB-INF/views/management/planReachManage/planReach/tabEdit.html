<div class="well well-sm" style="background:white;">
	  <ol class="breadcrumb">
		  <li style="color:#0b8d39;padding-left:15px;"> 当前位置：</li>
		  <li><a href="#/">首页</a></li>
	      <li><a href="javascript::" ui-sref="planReach">计划下达</a></li>	 
	      <li class="active">计划下达表单编辑</li>
	  </ol>
	  
	  <div class="toolbar">
	  	<a class="btn btn-success btn-sm" href="javascript:;" ui-sref="planReach_tabList"><span class="glyphicon glyphicon-chevron-left"></span>&nbsp;返回</a>
		<button ng-if="!vm.id" type="button" class="btn btn-success btn-sm" ng-click="vm.addPlanReachApproval()" ng-disabled="vm.isSubmit"><span class="glyphicon glyphicon-ok"></span>&nbsp;创建</button>
	  	<button ng-if="vm.id" type="button" class="btn btn-success btn-sm" ng-click="vm.editPlanReachApproval()" ng-disabled="vm.isSubmit"><span class="glyphicon glyphicon-ok"></span>&nbsp;更新</button>
	  	<button ng-if="vm.id" type="button" class="btn btn-success btn-sm" ng-click="vm.endProcesss()" ng-disabled="vm.isSubmit">全部办结</button>
	  </div>
	  
	    <div>
  	<form id="form" name="form">
  		<table class="table table-striped table-bordered">
  			<tr>
  				<td class="formAlignRight">标题：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="form-control input-sm" id="title" name="title" ng-model="vm.model.title" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="title" data-valmsg-replace="true" class="required"></span>
  				</td>
  				<td class="formAlignRight">制表时间：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="Wdate form-control input-sm" style="width:180px;" ng-model="vm.model.approvalTime" id="approvalTime" name="approvalTime"
								onClick="WdatePicker({isShowClear:false,readOnly:false,dateFmt:'yyyy-MM-dd',onpicked: function(){$(this).trigger('change')}})" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="approvalTime" data-valmsg-replace="true" class="required"></span>
  				</td>
  			</tr>
  			<tr>
  				<td class="formAlignRight">制表人：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="form-control input-sm" id="resPerson" name="resPerson" ng-model="vm.model.resPerson" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="resPerson" data-valmsg-replace="true" class="required"></span>
  				</td>
  				<td class="formAlignRight">制表人电话：<span class="required">(*)</span></td>
  				<td>
  					<input type="text" class="form-control input-sm" id="resPersonTel" name="resPersonTel" ng-model="vm.model.resPersonTel" data-val="true" data-val-required="必填"/>
  					<span data-valmsg-for="resPersonTel" data-valmsg-replace="true" class="required"></span>
  				</td>
  			</tr>
  			<tr>
  				<td colspan="4">
  					<table class="table table-striped table-bordered" style="margin-bottom:0;">
  						<tr>
  							<td class="text-center" colspan="13">
  								<p>
  									<strong style="font-size:1.2em">下达计划项目</strong>
  								</p>
  							</td>
  						</tr>
						<tr style="text-align: center;">
							<td rowspan="2">建设单位</td>
							<td rowspan="2" style="width: 160px;">项目名称</td>
							<td rowspan="2">建设性质</td>
							<td rowspan="2" style="width: 280px;">建设规模</td>
							
							<td rowspan="2">总投资</td>
							<td rowspan="2">累计安排</td>
							<td colspan="2">本计划安排投资</td>
							<td colspan="2">计划下达资金</td>
							<td rowspan="2" style="width: 160px;">主要建设内容 </td>
							<td rowspan="2" style="width: 160px;">备注 </td>
							<td rowspan="2" style="vertical-align: middle;"><button type="button" class="btn btn-success btn-sm" ng-click="vm.addPlanReach()"><span class="glyphicon glyphicon-plus"></span>&nbsp;添加</button></td>
						</tr>
						<tr style="text-align: center;">
							<td>公共预算</td>
							<td>国土资金</td>
							<td>公共预算</td>
							<td>国土资金</td>
						</tr>
 							<tbody ng-repeat="x in vm.model.shenBaoInfoDtos" style="text-align: center;">
 								<tr>
		  							<td ng-bind="x.constructionUnit"></td>
		  							<td ng-bind="x.projectName"></td>
		  								<td ng-bind="vm.getBasicDataDesc(x.projectConstrChar)"></td>
		  							<td rowspan="2" ng-bind="x.projectGuiMo" style="vertical-align: middle;"></td>
		  						
		  							<td ng-bind="x.projectInvestSum"></td>
		  							<td rowspan="2" ng-bind="x.apInvestSum" style="vertical-align: middle;"></td>
		  							<td rowspan="2" ng-bind="x.apPlanReach_ggys" style="vertical-align: middle;"></td>
		  							<td rowspan="2" ng-bind="x.apPlanReach_gtzj" style="vertical-align: middle;"></td>
		  							<td rowspan="2" style="vertical-align: middle;">
		  								<input style="width:70px" id="capitalSum1" ng-if="x.thisTaskName=='usertask5'" ng-model="vm.gg[x.id]" value="x.id" ng-blur="vm.addmoneys(x.id)"/>
		  								<span ng-hide="x.thisTaskName=='usertask5'" ng-bind="x.xdPlanReach_ggys"></span>
		  							</td>
		  							<td rowspan="2" style="vertical-align: middle;">
		  								<input style="width:70px" id="capitalSum2"  ng-if="x.thisTaskName=='usertask5'" ng-model="vm.gt[x.id]" value="x.id" ng-blur="vm.addmoneys(x.id)"/>
		  								<span ng-hide="x.thisTaskName=='usertask5'" ng-bind="x.xdPlanReach_gtzj"></span>
		  							</td>
		  							<td rowspan="2" ng-bind="x.yearConstructionTask" style="vertical-align: middle;"></td>
		  							<td rowspan="2" ng-bind="x.remark" style="vertical-align: middle;"></td>
		  							<td rowspan="2" style="vertical-align: middle;">
		  								<button type="button" class="btn btn-danger btn-sm" ng-click="vm.removePlanReach($index)"><span class="glyphicon glyphicon-remove"></span>&nbsp;移除</button>
		  								<button type="button" class="btn btn-success btn-sm" ng-if="x.thisTaskName=='usertask5'" ng-click="vm.endProcess(x.id)">办结</button>
		  								
		  							</td>
 								</tr>
						</tbody>
  					</table>
  				</td>
  			</tr>
  		</table>
  		 <!--项目申报记录模态框 -->
	<div class="modal fade" id="myModal" role="dialog"> 
		<div class="modal-dialog" style="width:1000px;"> 
			<div class="modal-content"> 
				<div class="modal-header bg-primary">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;	</button>  			
					<h4 class="modal-title" id="myModalLabel">计划下达数据</h4> 
				</div> 
				<div class="modal-body">
					<script type="text/template" id="columnBtn_planReachData">
						<button class="btn btn-sm btn-success" ng-click="vm.confirmPlanReach('{0}')">添加</button>
					</script>
					<div class="toolbar">
						<button class="btn btn-sm btn-success" ng-click="vm.confirmPlanReachs()">批量添加</button>
					</div>
					<div class="planReachDataGrid" kendo-grid="vm.planReachDataGrid" k-options="vm.gridOptions_planReachData"></div>			
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default btn-sm" data-dismiss="modal">关闭</button>	
				</div> 
			</div>
		</div>
	</div>
  	</form>
  </div>
</div>
<div ng-include src="'/contents/common/dialog-alert.tmpl.html'"></div>